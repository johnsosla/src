<apex:page standardController="Agreement__c" showHeader="true" sidebar="true" extensions="ECO_AgreementController" action="{!init}">
<apex:includeScript value="{!$Resource.ECO_jQuery_1_11_2_min_js}"/>
<apex:pageMessages id="pageMessages" escape="false" rendered="{!NOT(modalError)}"/>

    <style>
        .attachNewFile{
            visibility: hidden;
        }
        
        .tempAlert{
            text-align:center;
            padding:10px 15px;
            background-color:#fff996;
            font-size:13px;
            font-weight:bold;
            border:1px solid #FFDC48;
        }
        
        .tableStyle {border-collapse: collapse; border-spacing: 1px 1px; }
        .colStyle1 { width: 50%; padding: 2px 2px 2px 2px;  }
        .colStyle2 { width: 50%; padding: 0px 0px 0px 0px;                  }
        .rowstyle { border-bottom-style:solid; border-bottom-width:0px; border-bottom-color:#E8E8E8 }
        
        body .bPageBlock .pbBody .labelCol{
            padding-top: 3px !important;
            padding-bottom: 5px;
            vertical-align: middle;
        }       
       
        .halfWidthWrapper {
            width:50%;
            display:inline-block;
            float:left;
        }
        
        #notifications{
            margin-left:50%;
            padding-left:20px;
        }
                
        .customHelpIcon
        {
            display:inline-block;
            margin:0 5px 0 0;
            width:24px;
            height:24px;
            vertical-align:top !important;
        }
        /* CUSTOM HELP / GUIDANCE TEXT BOX */
        .customHelpText{
            padding: 7px;
            border: 1px solid #85B3CE;
            min-height: 10px;
            display: block;
            width: auto;
            margin: 0 0 5px 0;
            background-repeat: no-repeat;
            border-radius: 4px;
            background-color: #A2D3F1;
            
        }
        .customHelpBody{
            display:inline-block;
            color:#;
            max-width:95%;
        }           
        
        .infoTable {
            background: #f5f5f5;
            border-collapse: separate;
            font-size: 12px;
            line-height: 24px;
            text-align: left;
            margin:5px 14px 0 14px;
        }   
        .infoTable table{
            width:100%;
        }
        .infoTable th {
            background-color: #a6afa2 !important;
            color: #fff;
            font-weight: bold;
            padding: 3px 9px;
            position: relative;
            border:none !important;
        }
        .infoTable th:first-child{
            border-right:1px solid #fff !important;
        }

        .infoTable th:after {
            content: '';
            display: block;
            height: 25%;
            left: 0;
            margin: 1px 0 0 0;
            position: absolute;
            top: 25%;
            width: 100%;
        }
        .infoTable td {
            border-right: 1px solid #fff;
            border-left: 1px solid #e8e8e8;
            border-top: 1px solid #fff;
            border-bottom: 1px solid #e8e8e8;
            padding: 3px 9px;
            position: relative;
            transition: all 300ms;
            min-width: 90px;
        }   
        .printAgreement{
            padding:4px !important;
        } 

        .billRateTable {
          font-family: 'Arial';
          margin: 25px auto;
          border-collapse: collapse;
          /*border: 0px solid #eee;*/
          box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.1), 0px 10px 20px rgba(0, 0, 0, 0.05), 0px 20px 20px rgba(0, 0, 0, 0.05), 0px 30px 20px rgba(0, 0, 0, 0.05);
          width: 100%
        }

        .billRateTable tr{
          border-bottom: 1px solid #f2f3f3;
        }

        .billRateTable tr:hover {
          background: #e8f4f8;
        }

        .billRateTable tr:hover td {
            background: #e8f4f8;
        }

        .billRateTable th, .billRateTable td {
          border: 0px solid #eee;
          /*padding: 8px 2px 8px 5px;*/
          border-collapse: collapse;
        }

        .billRateTable td {
          background: #fff;
        }

        .billRateTable th {

          background:  #f2f3f3;
          font-size: .9em;
          font-weight: bold;  
          border: 0px solid #D3D3D3;
        }

        .billRateTable th.last {
          border-right: none;
        }
                 
        tr.dataRow {
           background-color:white;
         }
        
        tr.dataRow:hover {
           background-color: #e3f3ff;
         }

        .warningHelpText{
            padding: 7px;
            border: 1px solid #85B3CE;
            min-height: 30px;
            display: block;
            width: auto;
            margin: 0 0 5px 0;
            background-repeat: no-repeat;
            border-radius: 4px;
            background-color: yellow;            
        }
    </style>

<script>
    var j$ = jQuery.noConflict();

    j$(document).ready(function(){
        init();
    })

    function init(){
        //updateRequired();
        if(('{!projectId}' == ''|| '{!projectId}' == null) && '{!Agreement__c.RelatedProjectCount__c}' > 1 && '{!Agreement__c.IsMSA__c}' == "false") {
            openModal('modalProjectSelector');
            //return false;
        }
    }


    function updateRequired(){
        //enableRequired($x('.required'));
    }

    function addRequiredClasses(inputField) {
        inputField.prev().removeClass('requiredBlock').addClass('requiredBlock');
        inputField.parent().removeClass('requiredInput').addClass('requiredInput');
    }


    //function fileChosen(attachButton,documentField,overrideField)
    function fileChosen(attachButton,documentField)
    {
        if(documentField.value != '')
        {
            document.getElementById(attachButton).style.visibility = 'visible';         
            //document.getElementById(overrideField).value = '';
            //document.getElementById(overrideField).style.visibility = 'visible';
                        
        }
        else
        {
            document.getElementById(attachButton).style.visibility= 'hidden';
            //document.getElementById(overrideField).style.visibility= 'hidden';          
        }       
    }
    
    //function fileChosen2(attachButton,documentField,overrideField,comments)
    function fileChosen2(attachButton,documentField,comments)
    {
        if(documentField.value != '')
        {
            document.getElementById(attachButton).style.visibility = 'visible';         
            //document.getElementById(overrideField).value = '';
            //document.getElementById(overrideField).style.visibility = 'visible';
            document.getElementById(comments).style.visibility = 'visible';
                        
        }
        else
        {
            document.getElementById(attachButton).style.visibility= 'hidden';
            //document.getElementById(overrideField).style.visibility= 'hidden'; 
            document.getElementById(comments).style.visibility= 'hidden';                    
        }       
    } 
    
    //function fileChosen3(attachButton,documentField,overrideField,picklist, comments)
    function fileChosen3(attachButton,documentField,picklist, comments)
    {
        if(documentField.value != '')
        {
            document.getElementById(attachButton).style.visibility = 'visible';         
            //document.getElementById(overrideField).value = '';
            //document.getElementById(overrideField).style.visibility = 'visible';
            document.getElementById(picklist).style.visibility = 'visible';
            document.getElementById(comments).style.visibility = 'visible';
                        
        }
        else
        {
            document.getElementById(attachButton).style.visibility= 'hidden';
            //document.getElementById(overrideField).style.visibility= 'hidden'; 
            document.getElementById(picklist).style.visibility= 'hidden'; 
            document.getElementById(comments).style.visibility = 'hidden';                   
        }       
    }   

    function scopeChanged(scopeField, editField)
    {
        if(scopeField.value == '')
        {
            alert('Empty');
            document.getElementById(editField).style.visibility= 'hidden';
        }
        else
        {
            alert('Not Empty');
            document.getElementById(editField).style.visibility = 'visible';
        }
    }

    
    function primeScopeChanged()
    {
        primeScopeChanged();
    }
    
    function subScopeChanged()
    {
        subScopeChanged();
    }

    function changedAgreementStatus()
    {
        agreementStatusChanged();
    }
    
    function paymentTermChanged()
    {
        paymentTermChanged();
    }

    /*window.onload = function() {

        if(('{!projectId}' == ''|| '{!projectId}' == null) && '{!Agreement__c.RelatedProjectCount__c}' > 1 && '{!Agreement__c.IsMSA__c}' == "false") {
            openModal('modalProjectSelector');
            return false;
        }
    }*/

    function selectedProject()
    {
        relatedProjectSelected();
    }

    function cancelProjectSelect()
    {
       cancelProjectSelection();
    }
    
</script>

    <apex:outputText value="{!Agreement__c.SectionHeaderSubtitle__c}" rendered="false"/>
    
    <apex:outputPanel rendered="{!agreementRecordType =='Prime'}">
        <apex:sectionHeader title="{!$Label.Prime_Agreement_Edit}" subtitle="{!sectionHeaderSubtitle}" rendered="{!mode!= ''}"/>
        <apex:sectionHeader title="{!$Label.Prime_Agreement_FL}" subtitle="{!sectionHeaderSubtitle}" rendered="{!mode == ''}"/>
    </apex:outputPanel>

    <apex:outputPanel rendered="{!agreementRecordType =='Other'}">
        <apex:sectionHeader title="{!$Label.Other_Agreement_Edit}" subtitle="{!sectionHeaderSubtitle}" rendered="{!mode!= ''}"/>
        <apex:sectionHeader title="{!$Label.Other_Agreement}" subtitle="{!sectionHeaderSubtitle}" rendered="{!mode == ''}"/>
    </apex:outputPanel>
      
   <apex:outputPanel rendered="{!agreementRecordType =='PrimeInterimAgreement'}">
        <apex:sectionHeader title="{!$Label.Prime_Interim_Agreement_Edit}" subtitle="{!sectionHeaderSubtitle}" rendered="{!mode!= ''}"/>
        <apex:sectionHeader title="{!$Label.Prime_Interim_Agreement}" subtitle="{!sectionHeaderSubtitle}" rendered="{!mode == ''}"/>
    </apex:outputPanel>

    <apex:outputPanel rendered="{!agreementRecordType =='JointVenture'}">
        <apex:sectionHeader title="{!$Label.Joint_Venture_Agreement_Edit}" subtitle="{!sectionHeaderSubtitle}" rendered="{!mode!= ''}"/>
        <apex:sectionHeader title="{!$Label.Joint_Venture_Agreement}" subtitle="{!sectionHeaderSubtitle}" rendered="{!mode == ''}"/>
    </apex:outputPanel>    

    <apex:outputPanel rendered="{!agreementRecordType =='Sub'}">
        <apex:sectionHeader title="{!$Label.Sub_Agreement + ' ' + mode}" subtitle="{!sectionHeaderSubtitle}"/>
    </apex:outputPanel>

    <apex:outputPanel rendered="{!agreementRecordType =='InterCompany'}">
        <apex:sectionHeader title="{!$Label.Inter_Company_Agreement + ' ' + mode}" subtitle="{!sectionHeaderSubtitle}"/>
    </apex:outputPanel>

    <apex:outputPanel rendered="{!agreementRecordType =='PrimeTaskOrder'}">
        <apex:sectionHeader title="{!$Label.Prime_Task_Order_Agreement + ' ' + mode}" subtitle="{!sectionHeaderSubtitle}"/>
    </apex:outputPanel>

    <apex:outputPanel rendered="{!agreementRecordType !='PrimeMSA'}">
        <div class="customHelpText">
            <div class="customHelpBody">{!$Label.Non_MSA_Help_Text}</div>
        </div> 
    </apex:outputPanel>


    <apex:outputPanel rendered="{!agreementRecordType != 'PrimeMSA' && agreementRecordType != 'JointVenture' && agreementRecordType != 'Prime' && agreementRecordType != 'Sub' && agreementRecordType != 'InterCompany' && agreementRecordType != 'PrimeTaskOrder' && agreementRecordType != 'Other' && agreementRecordType != 'PrimeInterimAgreement'}">
        <apex:detail relatedList="treu" title="Test" inlineEdit="false"/>   
        <apex:form >
        <apex:pageBlock >
            <apex:pageBlockSection >
                <apex:outputField value="{!agreement.Name}" />
            
            </apex:pageBlockSection>
        
            <br />
            <br />
            <apex:outputText value="{!$Label.Agreement_Record_Type}"/><apex:outputText value="{agreementRecordType}"/>
            <apex:outputtext value="{!$Label.Contract_Review_Message}" />
            <br />
            <br />
            <apex:commandButton value="{!$Label.Initiate_Contract_Review}" />
            <br />
            <br />
    
    
        </apex:pageBlock>
        </apex:form>
    
        <apex:relatedList list="CombinedAttachments"/>
    
        <apex:relatedList list="PurchaseOrders__r"/>
        
        <apex:relatedList list="Funding__r" />
        <c:ECO_GenericHistoryComponent recordLimit1="50" myObject1="{!Agreement__c}" />
    
    </apex:outputPanel>

<!--                    Prime                               -->
    <apex:outputPanel rendered="{!agreementRecordType =='Prime'}" id="primeSection">
    <apex:form > 

        <apex:outputPanel style="display:none">
            <apex:outputField value="{!Agreement__c.RelatedProjectCount__c}"/>
            <apex:outputField value="{!Agreement__c.Project__c}"/>
        </apex:outputPanel>

        <apex:actionFunction name="relatedProjectSelected" action="{!relatedProjectSelectedApex}" status="queryStatus" immediate="false" />
        <apex:actionFunction name="cancelProjectSelection" action="{!cancelProjectSelection}" immediate="false"/>

        <c:ECO_ModalDialog width="350" padding="0px 0px 0px 0px" name="modalProjectSelector">

            <apex:pageBlock title="{!$Label.Project_Selector}">
                <apex:pageMessages />
                <div>
                    <apex:outputText >{!$Label.Agreement_Associated_To_Multiple_Projects}</apex:outputText>
                <br/><br/>
                </div>

                <apex:selectList value="{!projectId}" multiselect="false" size="1">
                    <apex:selectOptions value="{!RelatedProjects}" />
                </apex:selectList>

                <br/><br/>

                <apex:outputPanel id="btn1">
                    <div align="center">
                        <apex:outputPanel layout="inline" styleClass="btn" onclick="selectedProject(); return false;">Ok</apex:outputPanel>
                        <apex:outputPanel layout="inline" styleClass="btn" onclick="cancelProjectSelect();">Cancel</apex:outputPanel>
                    </div>
                </apex:outputPanel>

                <apex:actionStatus id="queryStatus">
                    <apex:facet name="start">
                        <p style="padding-bottom:20px;text-align:center;" class="searchText"><img style="position:relative;top:24px;" src="/img/loading32.gif" /> {!$Label.Loading_Agreement}</p>
                    </apex:facet>
                </apex:actionStatus>
            </apex:pageBlock>
        </c:ECO_ModalDialog> 

        <!--<apex:inputHidden value="{!Agreement__c.ScopePackage__c}"/>-->
        <!--<apex:actionFunction id="primeScopeChanged" name="primeScopeChanged" action="{!primeScopeChangedApex}" onComplete="window.location.reload();"/>-->
        <apex:actionFunction id="changedPrimeAgreementStatus" name="changedPrimeAgreementStatus" rerender="primeExecutionDetails" immediate="true"/>
        <apex:pageBlock mode="{!pageBlockMode}" title="{!$Label.Prime_Agreement_FL + ' ' + mode}">
        <apex:pageBlockButtons >
            <apex:commandLink value="{!$Label.Print_Agreement}" action="{!printPdf}" styleClass="btn printAgreement" immediate="true" target="_blank" style="text-decoration:none" />
            <apex:commandButton value="{!$Label.Save}" action="{!save}" rendered="{!mode != '' && hasUpdatePermission}"/>
            <apex:commandButton value="{!$Label.Return_to_Agreement}" action="{!cancel}" rendered="{!mode == 'Edit'}"/>   
            <apex:commandButton value="{!$Label.Edit}" action="{!editAgreement}" rendered="{!mode == '' && hasUpdatePermission}" immediate="true"/>   
            <apex:commandButton value="{!$Label.Initiate_Contract_Review}" action="{!initiateContractReview}" rendered="{!mode == ''}"/>
            <apex:commandButton value="{!$Label.Change_to_Prime_Task_Order}" action="{!switchToPrimeTask}" rendered="{!mode == ''}"/>
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!cancel}" rendered="{!mode == 'New' && agreement.Project__c != null}" immediate="true"/>
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!URLFOR($Action.pse__Proj__c.view, project.Id)}" rendered="{!mode != 'New'}" immediate="true" />
            <apex:commandButton value="{!$Label.Return_To_Project_Agreements}" action="{!returnToProjectAgreements}" rendered="{!mode == ''}" immediate="true" />
            <apex:commandButton value="{!$Label.Delete}" rendered="{!showDeleteButton && hasUpdatePermission}" action="{!deleteAgreement}"/>
            <apex:commandButton value="{!$Label.Cancel}" action="{!cancel}" rendered="{!agreement.Project__c == null && mode =='New'}" />
        </apex:pageBlockButtons>
        <apex:pageBlockSection >

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Name.inlineHelpText}">
                <apex:outputText value="{!$Label.ePM_Agreement_Number}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Name}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.Name}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementNumber__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Oracle_Agreement_No}"/>
                 <apex:outputPanel >
               <apex:outputField value="{!agreement.AgreementNumber__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.AgreementNumber__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Agreement_Status}"/>
                <apex:outputPanel >
                    <apex:actionRegion >
                        <apex:inputField value="{!agreement.AgreementStatus__c}" rendered="{!mode != ''}">
                            <apex:actionSupport event="onchange" immediate="false" rerender="primeExecutionDetails"/>
                        </apex:inputField>
                    </apex:actionRegion>
                    <apex:outputField value="{!agreement.AgreementStatus__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Project_Name}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Project__c}" rendered="{!mode == 'New' && project == null}" required="true" />                  
                    <apex:outputField value="{!project.Name}" rendered="{!mode == 'New' && project != null}" />
                    <apex:outputField value="{!project.Name}" rendered="{!mode != 'New'}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>            

            <apex:pageBlockSectionItem helptext="{!$Label.Billing_Client_Help_Text}">
                <apex:outputText value="{!$Label.Billing_Client_FL}"/>
                <apex:outputPanel >
                    <apex:selectList value="{!agreement.Account__c}" multiselect="false" size="1" rendered="{!mode != ''}" required="true">
                        <apex:selectOptions value="{!BillingAccounts}" />
                    </apex:selectList>
                    <apex:outputField value="{!agreement.Account__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>  


            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Ecosystem_Project_Reference_ID_FL}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.EcoSystemReferenceNumber__c}" rendered="{!mode == 'New'}"/>              
                    <apex:outputField value="{!project.EcoSystemReferenceNumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>
          
            <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Owner_Help_Text}">
                <apex:outputText value="{!$Label.Agreement_Owner_Label}"/>
                <apex:outputPanel >
                    <!-- <apex:inputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode == ''}"/>   -->
                    <apex:inputField value="{!agreement.AgreementOwner__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.AgreementOwner__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>          
       
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Oracle_Project_No}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.OracleProjectnumber__c}" rendered="{!mode == 'New'}"/>
                    <apex:outputField value="{!project.OracleProjectnumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>        
           
            </apex:pageBlockSection>    
  
            <apex:pageBlockSection title="{!$Label.Contract_Details}" collapsible="false">

            <apex:pageBlockSectionItem helptext="{!$Label.Type_of_Contract_Document}">
                <apex:outputText value="{!$Label.Contract_Type}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementType__c}" rendered="{!mode != ''}" required="true"/>               
                    <apex:outputField value="{!agreement.AgreementType__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>   

            <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Created_Date_Field}">
                <apex:outputText value="{!$Label.Create_Date_Field_Label}"/>
                <apex:outputField value="{!agreement.CreatedDate}"/>                
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ContractTitle__c.inlineHelpText}">
                <apex:outputText value="Contract Title/Name"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ContractTitle__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ContractTitle__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>    

             <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.StartDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Start_Date}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.StartDate__c}" rendered="{!mode != ''}"/>               
                    <apex:outputField value="{!agreement.StartDate__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>                           
          
             <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ClientContractReferenceNo__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Client_Contract_Reference_No}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ClientContractReferenceNo__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ClientContractReferenceNo__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExpirationDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.End_Date_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ExpirationDate__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.ExpirationDate__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>                         
            </apex:pageBlockSectionItem>

             <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ProfIndemnityLiabilityAmt__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Prof_Indemnity_Liability_Amt}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ProfIndemnityLiabilityAmt__c}" rendered="{!mode != ''}"/>   
                    <apex:outputField value="{!agreement.ProfIndemnityLiabilityAmt__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>                                         
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem >
                    <apex:outputText value="{!$Label.Contract_Review_Status_Field_Label}"/>
                    <apex:outputPanel >
                        <apex:outputText value="{!ContractReviewStatus}" rendered="{!mode == ''}"/> 
                    </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.PublicGeneralLiabilityAmt__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Public_General_Liability_Amt_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.PublicGeneralLiabilityAmt__c}" rendered="{!mode != ''}"/>               
                    <apex:outputField value="{!agreement.PublicGeneralLiabilityAmt__c}" rendered="{!mode == ''}"/>      
                </apex:outputPanel>     
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ContractTypeComments__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Contract_Type_Comments}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ContractTypeComments__c}" rendered="{!mode != ''}"/>               
                    <apex:outputField value="{!agreement.ContractTypeComments__c}" rendered="{!mode == ''}"/>      
                </apex:outputPanel>     
            </apex:pageBlockSectionItem>

            </apex:pageBlockSection>

        <apex:pageBlockSection columns="1">
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ScopePackage__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Scope_Package_Field_Label}"/>
                <apex:outputPanel >
                        <!--<apex:inputField value="{!agreement.ScopePackage__c}" rendered="{!mode != ''}" onchange="primeScopeChanged(); return true;"/> -->
                        <apex:inputField value="{!agreement.ScopePackage__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ScopePackage__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>    
                
            <apex:pageBlockSectionItem helptext="{!$Label.Scope_of_Services_Message}">
                <apex:outputText value="{!$Label.Scope_of_Services}"/>
                <apex:outputPanel id="primeScopeChanged">
                  <apex:inputField id="pscp1" style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode != '' }"/>               
                    <apex:outputField id="pscp2" style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode == ''}"/>
                    <!--<apex:outputText id="pscp3" style="width: 780px" value="{!primeScopeText}" rendered="{!agreement.ScopePackage__c != null}" escape="false"/>-->
                </apex:outputPanel>             
            </apex:pageBlockSectionItem>    
        </apex:pageBlockSection>             

            <apex:pageBlockSection title="{!$Label.Agreement_Currency_Note}" collapsible="false" columns="1">
                <apex:outputPanel rendered="{!Agreement__c.RelatedProjectCount__c > 1}">
                    <!-- US-07025 Update warning on Agreements attached to multiple projects-->                    <!--<div class="warningHelpText">{!$Label.Multiple_Project_Help_Text_and_Link}&nbsp;<b><apex:commandLink onclick="window.open('{!reportURL}');" value="Report" /></b>
                    </div>-->
                    <div class="warningHelpText">{!$Label.Multiple_Project_Help_Text_and_Link_Update}<br/><br/>{!$Label.Multiple_Project_Help_Text_and_Link_Update2}&nbsp;<b><apex:commandLink onclick="window.open('{!reportURL}');" value="Report" /></b>
                    </div>                  
                </apex:outputPanel>
            </apex:pageBlockSection>
            <apex:pageBlockSection collapsible="false">
            
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FeeType__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Fee_Type}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FeeType__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.FeeType__c}" rendered="{!mode == ''}"/>        
                </apex:outputPanel>     
            </apex:pageBlockSectionItem>            
      
        <apex:pageBlockSectionItem helpText="{!$Label.Total_Amount_of_Revenue_Message}">
            <apex:outputText value="{!$Label.Total_Approved_Revenue_Limit}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.TotalApprovedRevenueLimit__c}" rendered="{!mode != ''}" />
                <apex:outputField value="{!agreement.TotalApprovedRevenueLimit__c}" rendered="{!mode == ''}"/>                        
            </apex:outputPanel>
        </apex:pageBlockSectionItem>
           
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Payment_Terms_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.PaymentTerms__c}" rendered="{!mode != ''}" required="true">
                    </apex:inputField>
                    <apex:outputField value="{!agreement.PaymentTerms__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>             
            </apex:pageBlockSectionItem>    

            <apex:pageBlockSectionItem helpText="{!$Label.Total_Funding_Entered}">
                <apex:outputText value="{!$Label.Total_Funding_Amount}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode != ''}" required="true"/>              
                    <apex:outputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>
                      
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FundingCurrencyCode__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Currency}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>  
 
            <apex:pageBlockSectionItem helptext="{!$Label.Variance_Between_Approved_Revenue_and_Funding}">
                <apex:outputText value="{!$Label.Unallocated_Funding}"/>        
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.UnallocatedFunding__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.UnallocatedFunding__c}" rendered="{!mode == ''}"/>                        
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementAmountEstimated__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Amount_Estimated}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode != ''}"/>                
                    <apex:outputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>             
            </apex:pageBlockSectionItem>  

            <apex:pageBlockSectionItem helptext="{!$Label.Variance_Between_Approved_and_Confirmed}">
                <apex:outputText value="{!$Label.Variance_Field_Label}"/>
                <apex:outputField value="{!agreement.AgreementVariance__c}"/>                
            </apex:pageBlockSectionItem>              
   
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Amount__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Confirmed_And_Committed_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Amount__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.Amount__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>    
           
            <apex:pageBlockSectionItem helpText="{!$Label.Pick_Variance_Reason}">
                    <apex:outputText value="{!$Label.Variance_Reason_Field_Label}"/>
                    <apex:outputPanel >
                        <apex:inputField value="{!agreement.VarianceReason__c}" rendered="{!mode != ''}"/>  
                        <apex:outputField value="{!agreement.VarianceReason__c}" rendered="{!mode == ''}"/> 
                    </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem>   

            <apex:pageBlockSectionItem helpText="{!$ObjectType.Agreement__c.Fields.PotentialPerformanceBonus__c.inlineHelpText}">
                    <apex:outputText value="{!$Label.Potential_Performance_Bonus}"/>
                    <apex:outputPanel >
                        <apex:inputField value="{!agreement.PotentialPerformanceBonus__c}" rendered="{!mode != ''}"/>  
                        <apex:outputField value="{!agreement.PotentialPerformanceBonus__c}" rendered="{!mode == ''}"/> 
                    </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem>   

        </apex:pageBlockSection>

        <apex:pageBlockSection collapsible="false" columns="1">
            <apex:pageBlockSectionItem helpText="{!$ObjectType.Agreement__c.Fields.FinancialComments__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Financial_Comments}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FinancialComments__c}" rendered="{!mode != ''}" style="width: 780px"/>  
                    <apex:outputField value="{!agreement.FinancialComments__c}" rendered="{!mode == ''}" style="width: 780px"/> 
                </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem> 
        </apex:pageBlockSection>
        
        <apex:pageBlockSection title="{!$Label.Interim_Agreement_Work_At_Risk_if_applicable}" collapsible="false" columns="2">
            <apex:pageBlockSectionItem helptext="{!$Label.Interim_Approval_Help_Text}">
                <apex:outputText value="{!$Label.Interim_Approval_Type}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.InterimApprovalType__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.InterimApprovalType__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$Label.Interim_Approval_Date_Help_Text}">
                <apex:outputText value="{!$Label.Interim_Approval_Date}" />
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.InterimApprovalDate__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.InterimApprovalDate__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$Label.Interim_Revenue_Help_Text}">
                <apex:outputText value="{!$Label.Interim_Approval_Revenue_Fee_Limit}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.InterimApprovalRevenueFeeLimit__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.InterimApprovalRevenueFeeLimit__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$Label.Interim_Expire_Date_Help_Text}">
                <apex:outputText value="{!$Label.Interim_Approval_Expiry_Date}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.InterimApprovalExpiryDate__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.InterimApprovalExpiryDate__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helpText="{!$Label.Interim_Cost_Help_Text}" >
                <apex:outputText value="{!$Label.Interim_Approval_Cost_Limit}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.InterimApprovalCostLimit__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.InterimApprovalCostLimit__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>

        <apex:pageBlockSection columns="1">
                <apex:pageBlockSectionItem helpText="{!$Label.Interim_Approval_Comments_Help_Text}">
                    <apex:outputText value="{!$Label.Interim_Approval_Comments}"/>
                    <apex:outputPanel >
                        <apex:inputField style="width:780px" value="{!agreement.InterimApprovalComments__c}" rendered="{!mode != ''}"/>  
                        <apex:outputText style="width:780px" value="{!agreement.InterimApprovalComments__c}" rendered="{!mode == ''}"/> 
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>

    <apex:outputPanel id="primeExecutionDetails">
    <apex:pageBlockSection title="{!$Label.Agreement_Execution_Details}" collapsible="false">
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c =='Executed'}"/>
                <apex:outputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode == ''}"/>    
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>    

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExecutionDate__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Execution_Date}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ExecutionDate__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c =='Executed'}"/>
                <apex:outputField value="{!agreement.ExecutionDate__c}" rendered="{!mode == ''}"/>  
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>   

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy2__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode == ''}"/>    
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>

    </apex:pageBlockSection>
    </apex:outputPanel>


        </apex:pageBlock>
        <apex:inputHidden value="{!projectFundingId}" id="testfunding"/>
        <apex:actionFunction name="manageFundingProjectLevel" id="manageFundingProjectLevel" action="{!manageFundingByProject}" rerender="testfunding">
            <apex:param id="projId" name="fundingProjectId" value="" assignTo="{!projectFundingId}"/>
        </apex:actionFunction>        
        
        <apex:pageBlock title="{!$Label.Funding}" rendered="{!mode == ''}">       
            <apex:pageBlockButtons location="top"><apex:commandButton value="{!$Label.Manage_Funding}" action="{!manageFunding}" immediate="true"/></apex:pageBlockButtons>
            <apex:outputPanel id="fundingPanel">
            <apex:outputPanel rendered="{!fundings != null && fundings.size > 0}">
            <apex:pageBlockTable value="{!fundings}" var="funding">
                <apex:column headervalue="{!$Label.Date_Allocated}">
                    <apex:outputField value="{!funding.CreatedDate}" rendered="{!funding.DateAllocatedDate__c == null}"></apex:outputField>
                    <apex:outputField value="{!funding.DateAllocatedDate__c}" rendered="{!funding.DateAllocatedDate__c != null}"></apex:outputField>                    
                </apex:column>   
                <apex:column headervalue="{!$Label.Classification}">
                    <apex:outputField value="{!funding.FundingClassification__c}"/>
                </apex:column>               
                <apex:column headervalue="{!$Label.Allocated_Amount}">
                    <apex:outputField value="{!funding.TotalBaselinedAmount__c}" rendered="{!funding.AllocatedAmount__c==null}"/>
                    <apex:outputField value="{!funding.AllocatedAmount__c}" rendered="{!funding.AllocatedAmount__c!=null}"/>
                </apex:column>
        </apex:pageBlockTable>   
        </apex:outputPanel>
        </apex:outputPanel>
                  
        <apex:outputPanel rendered="{!fundings.size == 0}">
            <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
        </apex:outputPanel> 
        </apex:pageBlock>   

        <apex:pageBlock title="{!$Label.Contract_Reviews}" rendered="{!mode == '' && contractReviews != null}">
        <apex:outputPanel rendered="{!contractReviews != null && contractReviews.size > 0}">
            <apex:pageBlockTable value="{!contractReviews}" var="contractReview">
    
                <apex:column headervalue="{!$Label.Contract_Review_Id}">
                    <apex:commandlink action="{!URLFOR($Action.Contract_Review__c.view, contractReview.Id)}"><apex:outputField value="{!contractReview.Name}"/></apex:commandLink>
                </apex:column>          

                <apex:column headervalue="{!$Label.Review_Status}">
                    <apex:outputField value="{!contractReview.Status_Review__c}"/>
                </apex:column>    
                <apex:column headervalue="{!$Label.Review_Request_Type}">
                    <apex:outputField value="{!contractReview.Review_Request_Type__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Opportunity_Name}">
                    <apex:outputField value="{!contractReview.Opportunity_Name__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Date_Review_is_Required}">
                    <apex:outputField value="{!contractReview.Date_Required__c}"/>
                </apex:column>                                  
                <apex:column headervalue="{!$Label.Client_Vendor}">
                    <apex:outputField value="{!contractReview.Client_Vendor__c}"/>
                </apex:column>  
            </apex:pageBlockTable>

        </apex:outputPanel>
        <apex:outputPanel rendered="{!contractReviews == null && contractReviews.size == 0}">
            <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
        </apex:outputPanel> 
        </apex:pageBlock> 

<!--         <c:ECO_MSAFlyout MSAId="{!agreement.MSAReference__c}" rendered="{!agreement.MSAReference__c != null}" id="primeMSAFlyout"/>  -->     
<!--bk        <c:ECO_RiskFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="" />
        <c:ECO_AssumptionFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="Agreements" />
        <c:ECO_ProjectTeamFlyout ProjectId="{!project.Id}" rendered="{!project != null}"  /> -->
    </apex:form>
 
    <!--<apex:relatedList list="ContractReviews__r" rendered="{!mode==''}"/>-->
    <apex:relatedList list="CombinedAttachments" rendered="{!mode == ''}" />   
    <c:ECO_GenericHistoryComponent recordLimit1="25" myObject1="{!Agreement__c}" />
    </apex:outputPanel>
    
<!-- Other -->
    <apex:outputPanel rendered="{!agreementRecordType =='Other'}">
    <apex:form > 
        <!--<apex:actionFunction id="primeScopeChanged" name="primeScopeChanged" rerender="primeScope"/>-->

        <apex:pageBlock mode="{!pageBlockMode}" title="{!'Other Agreement ' + mode}">
        <apex:pageBlockButtons >
            <apex:commandLink value="{!$Label.Print_Agreement}" action="{!printPdf}" styleClass="btn printAgreement" immediate="true" target="_blank" style="text-decoration:none" />
            <apex:commandButton value="{!$Label.Save}" action="{!save}" rendered="{!mode != '' && hasUpdatePermission}"/>
            <apex:commandButton value="{!$Label.Return_to_Agreement}" action="{!cancel}" rendered="{!mode == 'Edit'}"/>   
            <apex:commandButton value="{!$Label.Edit}" action="{!editAgreement}" rendered="{!mode == '' && hasUpdatePermission}" immediate="true"/>   
            <apex:commandButton value="{!$Label.Initiate_Contract_Review}" action="{!initiateContractReview}" rendered="{!mode == ''}"/>
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!cancel}" rendered="{!mode == 'New' && agreement.Project__c != null}" immediate="true"/>
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!URLFOR($Action.pse__Proj__c.view, project.Id)}" rendered="{!mode != 'New'}" immediate="true"/>
            <apex:commandButton value="{!$Label.Return_To_Project_Agreements}" action="{!returnToProjectAgreements}" rendered="{!mode == ''}" immediate="true"/>
            <apex:commandButton value="{!$Label.Delete}" rendered="{!showDeleteButton && hasUpdatePermission}" action="{!deleteAgreement}"/>
            <apex:commandButton value="{!$Label.Cancel}" action="{!cancel}" rendered="{!agreement.Project__c == null && mode =='New'}" />
        </apex:pageBlockButtons>
    <apex:pageBlockSection >
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Name.inlineHelpText}">
                <apex:outputText value="{!$Label.ePM_Agreement_Number}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Name}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.Name}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementNumber__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Oracle_Agreement_No}"/>
            <apex:outputPanel >
                <apex:outputField value="{!agreement.AgreementNumber__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.AgreementNumber__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Agreement_Status}"/>
                <apex:outputPanel >
                    <apex:actionRegion >
                        <apex:inputField value="{!agreement.AgreementStatus__c}" rendered="{!mode != ''}">
                            <apex:actionSupport event="onchange" immediate="false" rerender="otherExecutionDetails"/>
                        </apex:inputField>
                    </apex:actionRegion>
                    <apex:outputField value="{!agreement.AgreementStatus__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Project_Name}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Project__c}" rendered="{!mode == 'New' && project == null}" required="true" />                  
                    <apex:outputField value="{!project.Name}" rendered="{!mode == 'New' && project != null}" />
                    <apex:outputField value="{!agreement.Project__r.Name}" rendered="{!mode != 'New'}"/>    
                </apex:outputPanel>         
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ParentAgreement__c.inlineHelpText}">
                <apex:outputText value="Parent Agreement"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ParentAgreement__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ParentAgreement__c}" rendered="{!mode == ''}"/>        
                </apex:outputPanel>     
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Ecosystem_Project_Reference_ID_FL}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.EcoSystemReferenceNumber__c}" rendered="{!mode == 'New'}"/>              
                    <apex:outputField value="{!agreement.Project__r.EcoSystemReferenceNumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
        </apex:pageBlockSectionItem>
       
        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Oracle_Project_No}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.OracleProjectnumber__c}" rendered="{!mode == 'New'}"/>
                    <apex:outputField value="{!agreement.Project__r.OracleProjectnumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Agreement_With__c.inlineHelpText}">
            <apex:outputText value="Agreement With"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.Agreement_With__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.Agreement_With__c}" rendered="{!mode == ''}"/>        
            </apex:outputPanel>     
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem >

        </apex:pageBlockSectionItem>      
              
        <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Owner_Help_Text}">
                <apex:outputText value="{!$Label.Agreement_Owner_Label}"/>
                <apex:outputPanel >
                    <!--<apex:inputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode == ''}"/>  -->
                    <apex:inputField value="{!agreement.AgreementOwner__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.AgreementOwner__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
        </apex:pageBlockSectionItem>
      
    </apex:pageBlockSection>

    <apex:pageBlockSection collapsible="false" title="{!$Label.Contract_Details}">  

        <apex:pageBlockSectionItem helptext="{!$Label.Type_of_Contract_Document}">
            <apex:outputText value="{!$Label.Contract_Type}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementType__c}" rendered="{!mode != ''}" required="true"/>               
                <apex:outputField value="{!agreement.AgreementType__c}" rendered="{!mode == ''}"/>  
            </apex:outputPanel>         
        </apex:pageBlockSectionItem> 
            
        <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Created_Date_Field}">
                <apex:outputText value="{!$Label.Create_Date_Field_Label}"/>
                <apex:outputField value="{!agreement.CreatedDate}"/>                
        </apex:pageBlockSectionItem>    
                
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ContractTitle__c.inlineHelpText}">
            <apex:outputText value="Contract Title/Name"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ContractTitle__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.ContractTitle__c}" rendered="{!mode == ''}"/>  
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.StartDate__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Start_Date}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.StartDate__c}" rendered="{!mode != ''}"/>               
                <apex:outputField value="{!agreement.StartDate__c}" rendered="{!mode == ''}"/>  
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>     
        
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ClientContractReferenceNo__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Client_Contract_Reference_No}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ClientContractReferenceNo__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.ClientContractReferenceNo__c}" rendered="{!mode == ''}"/>  
            </apex:outputPanel>         
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExpirationDate__c.inlineHelpText}">
            <apex:outputText value="{!$Label.End_Date_Field_Label}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ExpirationDate__c}" rendered="{!mode != ''}"/>  
                <apex:outputField value="{!agreement.ExpirationDate__c}" rendered="{!mode == ''}"/> 
            </apex:outputPanel>                         
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ProfIndemnityLiabilityAmt__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Prof_Indemnity_Liability_Amt}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ProfIndemnityLiabilityAmt__c}" rendered="{!mode != ''}"/>   
                    <apex:outputField value="{!agreement.ProfIndemnityLiabilityAmt__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>                                         
        </apex:pageBlockSectionItem>   

        <apex:pageBlockSectionItem >
            <apex:outputText value="{!$Label.Contract_Review_Status_Field_Label}"/>
            <apex:outputPanel >
                <apex:outputText value="{!ContractReviewStatus}" rendered="{!mode == ''}"/> 
            </apex:outputPanel>                                                 
        </apex:pageBlockSectionItem> 
          
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.PublicGeneralLiabilityAmt__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Public_General_Liability_Amt_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.PublicGeneralLiabilityAmt__c}" rendered="{!mode != ''}"/>               
                    <apex:outputField value="{!agreement.PublicGeneralLiabilityAmt__c}" rendered="{!mode == ''}"/>      
                </apex:outputPanel>     
        </apex:pageBlockSectionItem>                

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ContractTypeComments__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Contract_Type_Comments}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ContractTypeComments__c}" rendered="{!mode != ''}"/>               
                <apex:outputField value="{!agreement.ContractTypeComments__c}" rendered="{!mode == ''}"/>      
            </apex:outputPanel>     
        </apex:pageBlockSectionItem>

    </apex:pageBlockSection>
         
    <apex:pageBlockSection columns="1">
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ScopePackage__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Scope_Package_Field_Label}"/>
            <apex:outputPanel >
                <!--<apex:inputField value="{!agreement.ScopePackage__c}" onChange="primeScopeChanged();" rendered="{!mode != ''}"/>  -->
                <apex:inputField value="{!agreement.ScopePackage__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.ScopePackage__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>               

        <apex:pageBlockSectionItem helptext="{!$Label.Scope_of_Services_Message}">
            <apex:outputText value="{!$Label.Scope_of_Services}"/>
            <apex:outputPanel id="primeScope">
                <apex:inputField style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode != ''}"/>               
                <apex:outputField style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode == ''}"/>
                <!--<apex:outputField style="width: 780px" value="{!agreement.ScopePackage__r.Scope_Details__c}" rendered="{!agreement.ScopePackage__c != null}" />-->
                </apex:outputPanel>             
        </apex:pageBlockSectionItem>    
    </apex:pageBlockSection> 

    <apex:pageBlockSection collapsible="false" title="{!$Label.Agreement_Currency_Note}">
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FeeType__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Fee_Type}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.FeeType__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.FeeType__c}" rendered="{!mode == ''}"/>        
            </apex:outputPanel>     
        </apex:pageBlockSectionItem>            

        <apex:pageBlockSectionItem helpText="{!$Label.Total_Amount_of_Revenue_Message}" >
            <apex:outputText value="{!$Label.Total_Approved_Revenue_Limit}"/>
            <apex:outputPanel id="totalApprovedRevenueLimit">
                <apex:outputPanel >
                        <apex:inputField value="{!agreement.TotalApprovedRevenueLimit__c}" rendered="{!mode != ''}" />
                    <apex:outputField value="{!agreement.TotalApprovedRevenueLimit__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:outputPanel>
            </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem >
            <apex:outputText value="{!$Label.Payment_Terms_Field_Label}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.PaymentTerms__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.PaymentTerms__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>             
        </apex:pageBlockSectionItem>    


        <apex:pageBlockSectionItem helpText="{!$Label.Total_Funding_Entered}">
            <apex:outputText value="{!$Label.Total_Funding_Amount}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode != ''}" required="true"/>              
                <apex:outputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode == ''}"/> 
            </apex:outputPanel>         
        </apex:pageBlockSectionItem> 
           
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FundingCurrencyCode__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Currency}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
        </apex:pageBlockSectionItem>    

        <apex:pageBlockSectionItem helpText="{!$Label.Variance_Between_Approved_Revenue_and_Funding}" >
            <apex:outputText value="{!$Label.Unallocated_Funding}"/>
            <apex:outputPanel >

            </apex:outputPanel>

        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementAmountEstimated__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Amount_Estimated}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode != ''}"/>                
                <apex:outputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>             
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem helptext="{!$Label.Variance_Between_Approved_and_Confirmed}">
                <apex:outputText value="{!$Label.Variance_Field_Label}"/>
                <apex:outputField value="{!agreement.AgreementVariance__c}"/>                
        </apex:pageBlockSectionItem>   
  
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Amount__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Confirmed_And_Committed_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Amount__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.Amount__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
        </apex:pageBlockSectionItem>    
                                            
        <apex:pageBlockSectionItem helpText="{!$Label.Pick_Variance_Reason}">
                    <apex:outputText value="{!$Label.Variance_Reason_Field_Label}"/>
                    <apex:outputPanel >
                        <apex:inputField value="{!agreement.VarianceReason__c}" rendered="{!mode != ''}"/>  
                        <apex:outputField value="{!agreement.VarianceReason__c}" rendered="{!mode == ''}"/> 
                    </apex:outputPanel>                                                 
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem helpText="{!$ObjectType.Agreement__c.Fields.PotentialPerformanceBonus__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Potential_Performance_Bonus}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.PotentialPerformanceBonus__c}" rendered="{!mode != ''}"/>  
                <apex:outputField value="{!agreement.PotentialPerformanceBonus__c}" rendered="{!mode == ''}"/> 
            </apex:outputPanel>                                                 
        </apex:pageBlockSectionItem>        
  
    </apex:pageBlockSection>

    <apex:pageBlockSection collapsible="false" columns="1">
        <apex:pageBlockSectionItem helpText="{!$ObjectType.Agreement__c.Fields.FinancialComments__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Financial_Comments}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.FinancialComments__c}" rendered="{!mode != ''}" style="width: 780px"/>  
                <apex:outputField value="{!agreement.FinancialComments__c}" rendered="{!mode == ''}" style="width: 780px"/> 
            </apex:outputPanel>                                                 
        </apex:pageBlockSectionItem> 
    </apex:pageBlockSection>

    <apex:pageBlockSection collapsible="false" title="{!$Label.Agreement_Execution_Details}" id="otherExecutionDetails">
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c == 'Executed'}"/>
                <apex:outputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode == ''}"/>    
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>     

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExecutionDate__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Execution_Date}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ExecutionDate__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.ExecutionDate__c}" rendered="{!mode == ''}"/>  
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy2__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode == ''}"/>    
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>                       
                                                                                                                                   
        </apex:pageBlockSection>
        
  
        </apex:pageBlock>
        <apex:inputHidden value="{!projectFundingId}" id="testfunding"/>
        <apex:actionFunction name="manageFundingProjectLevel" id="manageFundingProjectLevel" action="{!manageFundingByProject}" rerender="testfunding">
            <apex:param id="projId" name="fundingProjectId" value="" assignTo="{!projectFundingId}"/>
        </apex:actionFunction>        
        
        <apex:pageBlock title="{!$Label.Funding}" rendered="{!mode == '' && agreementRecordType != 'Other'}">       
            <apex:pageBlockButtons location="top"><apex:commandButton value="{!$Label.Manage_Funding}" action="{!manageFunding}" immediate="true"/></apex:pageBlockButtons>
            <apex:outputPanel id="fundingPanel" rendered="{!projects.size == 1}">
            <apex:outputPanel rendered="{!fundings != null && fundings.size > 0}">
            <apex:pageBlockTable value="{!fundings}" var="funding">
                <apex:column headervalue="{!$Label.Date_Allocated}">
                    <apex:outputField value="{!funding.CreatedDate}" rendered="{!funding.DateAllocatedDate__c == null}"></apex:outputField>
                    <apex:outputField value="{!funding.DateAllocatedDate__c}" rendered="{!funding.DateAllocatedDate__c != null}"></apex:outputField>                    
                </apex:column>           
                <apex:column headervalue="{!$Label.Classification}">
                    <apex:outputField value="{!funding.FundingClassification__c}"/>
                </apex:column>                        
                <apex:column headervalue="{!$Label.Allocated_Amount}">
                    <apex:outputField value="{!funding.TotalBaselinedAmount__c}" rendered="{!funding.AllocatedAmount__c==null}"/>
                    <apex:outputField value="{!funding.AllocatedAmount__c}" rendered="{!funding.AllocatedAmount__c!=null}"/>
                </apex:column>
        </apex:pageBlockTable>   
        </apex:outputPanel>
        </apex:outputPanel>

        <apex:outputPanel rendered="{!fundings.size == 0}">
            <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
        </apex:outputPanel> 
        </apex:pageBlock>     

        <apex:pageBlock title="{!$Label.Contract_Reviews}" rendered="{!mode == ''}">
        <apex:outputPanel rendered="{!contractReviews != null && contractReviews.size > 0}">
            <apex:pageBlockTable value="{!contractReviews}" var="contractReview">
    
                <apex:column headervalue="{!$Label.Contract_Review_Id}">
                    <apex:commandlink action="{!URLFOR($Action.Contract_Review__c.view, contractReview.Id)}"><apex:outputField value="{!contractReview.Name}"/></apex:commandLink>
                </apex:column>          

                <apex:column headervalue="{!$Label.Review_Status}">
                    <apex:outputField value="{!contractReview.Status_Review__c}"/>
                </apex:column>    
                <apex:column headervalue="{!$Label.Review_Request_Type}">
                    <apex:outputField value="{!contractReview.Review_Request_Type__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Opportunity_Name}">
                    <apex:outputField value="{!contractReview.Opportunity_Name__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Date_Review_is_Required}">
                    <apex:outputField value="{!contractReview.Date_Required__c}"/>
                </apex:column>                                  
                <apex:column headervalue="{!$Label.Client_Vendor}">
                    <apex:outputField value="{!contractReview.Client_Vendor__c}"/>
                </apex:column>  
            </apex:pageBlockTable>

        </apex:outputPanel>
        <apex:outputPanel rendered="{!contractReviews == null && contractReviews.size == 0}">
            <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
        </apex:outputPanel> 
        </apex:pageBlock> 

        <c:ECO_RiskFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="" />
        <c:ECO_AssumptionFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="Agreements" />
        <c:ECO_ProjectTeamFlyout ProjectId="{!project.Id}" rendered="{!project != null}"  />
        <c:ECO_GenericHistoryComponent recordLimit1="50" myObject1="{!Agreement__c}" />

    </apex:form>
 
    <!--<apex:relatedList list="ContractReviews__r" rendered="{!mode==''}"/>-->
    <apex:relatedList list="CombinedAttachments" rendered="{!mode == ''}" />   
    </apex:outputPanel> 
    
    <!-- Prime Interim Agreement -->
    <apex:outputPanel rendered="{!agreementRecordType =='PrimeInterimAgreement'}">
    <apex:form > 
        <!--<apex:actionFunction id="primeScopeChanged" name="primeScopeChanged" rerender="primeScope"/>-->

        <apex:pageBlock mode="{!pageBlockMode}" title="{!$Label.Prime_Agreement_FL + ' ' + mode}">
        <apex:pageBlockButtons >
            <apex:commandLink value="{!$Label.Print_Agreement}" action="{!printPdf}" styleClass="btn printAgreement" immediate="true" target="_blank" style="text-decoration:none" />
            <apex:commandButton value="{!$Label.Save}" action="{!save}" rendered="{!mode != '' && hasUpdatePermission}"/>
            <apex:commandButton value="{!$Label.Return_to_Agreement}" action="{!cancel}" rendered="{!mode == 'Edit'}"/>   
            <apex:commandButton value="{!$Label.Edit}" action="{!editAgreement}" rendered="{!mode == '' && hasUpdatePermission}" immediate="true"/>   
            <apex:commandButton value="{!$Label.Initiate_Contract_Review}" action="{!initiateContractReview}" rendered="{!mode == ''}"/>
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!URLFOR($Action.pse__Proj__c.view, project.Id)}" rendered="{!mode != 'New'}" immediate="true"/>
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!cancel}" rendered="{!mode == 'New' && agreement.Project__c != null}" immediate="true"/>
            <apex:commandButton value="{!$Label.Return_To_Project_Agreements}" action="{!returnToProjectAgreements}" rendered="{!mode == ''}" immediate="true"/>
            <apex:commandButton value="{!$Label.Delete}" rendered="{!showDeleteButton && hasUpdatePermission}" action="{!deleteAgreement}"/>
            <apex:commandButton value="{!$Label.Cancel}" action="{!cancel}" rendered="{!agreement.Project__c == null && mode =='New'}" />
        </apex:pageBlockButtons>
        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Name.inlineHelpText}">
                <apex:outputText value="{!$Label.ePM_Agreement_Number}r"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Name}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.Name}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Ecosystem_Project_Reference_ID_FL}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.EcoSystemReferenceNumber__c}" rendered="{!mode == 'New'}"/>              
                    <apex:outputField value="{!agreement.Project__r.EcoSystemReferenceNumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Agreement_Status}"/>
                <apex:outputPanel >
                    <apex:actionRegion >
                        <apex:inputField value="{!agreement.AgreementStatus__c}" rendered="{!mode != ''}">
                            <apex:actionSupport event="onchange" immediate="false" rerender="intExecutedBy,intExecutedDate"/>
                        </apex:inputField>
                    </apex:actionRegion>
                    <apex:outputField value="{!agreement.AgreementStatus__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>        
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Oracle_Project_No}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.OracleProjectnumber__c}" rendered="{!mode == 'New'}"/>
                    <apex:outputField value="{!agreement.Project__r.OracleProjectnumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>        
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementNumber__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Oracle_Agreement_No}"/>
                 <apex:outputPanel >
               <apex:inputField value="{!agreement.AgreementNumber__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.AgreementNumber__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>    
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Project_Name}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Project__c}" rendered="{!mode == 'New' && project == null}" required="true" />                  
                    <apex:outputField value="{!project.Name}" rendered="{!mode == 'New' && project != null}" />
                    <apex:outputField value="{!agreement.Project__r.Name}" rendered="{!mode != 'New'}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>    
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ParentAgreement__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Parent_Agreement}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ParentAgreement__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ParentAgreement__c}" rendered="{!mode == ''}"/>        
                </apex:outputPanel>     
            </apex:pageBlockSectionItem>            
            <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Owner_Help_Text}">
                <apex:outputText value="{!$Label.Agreement_Owner_Label}"/>
                <apex:outputPanel >
                    <!--<apex:inputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode == ''}"/>  -->
                    <apex:inputField value="{!agreement.AgreementOwner__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.AgreementOwner__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$Label.Billing_Client_Help_Text}">
                <apex:outputText value="{!$Label.Billing_Client_FL}"/>
                <apex:outputPanel >
                    <apex:selectList value="{!agreement.Account__c}" multiselect="false" size="1" rendered="{!mode != ''}" required="true">
                        <apex:selectOptions value="{!BillingAccounts}" />
                    </apex:selectList>
                    <apex:outputField value="{!agreement.Account__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c == 'Executed'}" id="intExecutedBy"/>
                    <apex:outputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>    
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.InvoicingClient__c.inlineHelpText}">
                <apex:outputText value="Invoicing Client"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.InvoicingClient__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.InvoicingClient__c}" rendered="{!mode == ''}"/>        
                </apex:outputPanel>     
            </apex:pageBlockSectionItem>        
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy2__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>  

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExecutionDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Execution_Date}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ExecutionDate__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c == 'Executed'}" id="intExecutedDate"/>
                    <apex:outputField value="{!agreement.ExecutionDate__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>    
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ContractTitle__c.inlineHelpText}">
                <apex:outputText value="Contract Title/Name"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ContractTitle__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ContractTitle__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>        

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FeeType__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Fee_Type}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FeeType__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.FeeType__c}" rendered="{!mode == ''}"/>        
                </apex:outputPanel>     
            </apex:pageBlockSectionItem>        

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ClientContractReferenceNo__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Client_Contract_Reference_No}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ClientContractReferenceNo__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ClientContractReferenceNo__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>            

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Payment_Terms_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.PaymentTerms__c}" rendered="{!mode != ''}" required="true">
                    </apex:inputField>
                    <apex:outputField value="{!agreement.PaymentTerms__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>             
            </apex:pageBlockSectionItem>    

            <apex:pageBlockSectionItem helptext="{!$Label.Type_of_Contract_Document}">
                <apex:outputText value="{!$Label.Contract_Type}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementType__c}" rendered="{!mode != ''}" required="true"/>               
                    <apex:outputField value="{!agreement.AgreementType__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>            
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FundingCurrencyCode__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Currency}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>    
            <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Created_Date_Field}">
                <apex:outputText value="{!$Label.Create_Date_Field_Label}"/>
                <apex:outputField value="{!agreement.CreatedDate}"/>                
            </apex:pageBlockSectionItem>    
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Amount__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Confirmed_And_Committed_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Amount__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.Amount__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>    
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.StartDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Start_Date}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.StartDate__c}" rendered="{!mode != ''}"/>               
                    <apex:outputField value="{!agreement.StartDate__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>                                            
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementAmountEstimated__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Amount_Estimated}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode != ''}"/>                
                    <apex:outputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>             
            </apex:pageBlockSectionItem>        
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExpirationDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.End_Date_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ExpirationDate__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.ExpirationDate__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>                         
            </apex:pageBlockSectionItem>    
            <apex:pageBlockSectionItem helpText="{!$Label.Total_Funding_Entered}">
                <apex:outputText value="{!$Label.Total_Funding_Amount}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode != ''}" required="true"/>              
                    <apex:outputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>        
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ProfIndemnityLiabilityAmt__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Prof_Indemnity_Liability_Amt}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ProfIndemnityLiabilityAmt__c}" rendered="{!mode != ''}"/>   
                    <apex:outputField value="{!agreement.ProfIndemnityLiabilityAmt__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>                                         
            </apex:pageBlockSectionItem>    
            <apex:pageBlockSectionItem helptext="{!$Label.Variance_Between_Approved_and_Confirmed}">
                <apex:outputText value="{!$Label.Variance_Field_Label}"/>
                <apex:outputField value="{!agreement.AgreementVariance__c}"/>                
            </apex:pageBlockSectionItem>            
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.PublicGeneralLiabilityAmt__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Public_General_Liability_Amt_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.PublicGeneralLiabilityAmt__c}" rendered="{!mode != ''}"/>               
                    <apex:outputField value="{!agreement.PublicGeneralLiabilityAmt__c}" rendered="{!mode == ''}"/>      
                </apex:outputPanel>     
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem helpText="{!$Label.Pick_Variance_Reason}">
                    <apex:outputText value="{!$Label.Variance_Reason_Field_Label}"/>
                    <apex:outputPanel >
                        <apex:inputField value="{!agreement.VarianceReason__c}" rendered="{!mode != ''}"/>  
                        <apex:outputField value="{!agreement.VarianceReason__c}" rendered="{!mode == ''}"/> 
                    </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem>   

            <apex:pageBlockSectionItem >
                    <apex:outputText value="{!$Label.Contract_Review_Status_Field_Label}"/>
                    <apex:outputPanel >
                        <apex:outputText value="{!ContractReviewStatus}" rendered="{!mode == ''}"/> 
                    </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem> 
                             
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Revenue_Limit}"/>
                <apex:outputPanel >
                        <apex:inputField value="{!agreement.RevenueLimitFlag__c}" rendered="{!mode != ''}"/>  
                        <apex:outputField value="{!agreement.RevenueLimitFlag__c}" rendered="{!mode == ''}"/>                 
                </apex:outputPanel>     
            </apex:pageBlockSectionItem>    
            
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Action_Code}"/>
                <apex:outputPanel >
                <apex:inputField value="{!agreement.ActionCode__c}" rendered="{!mode == 'Edit'}"  />                           
                
                <apex:outputField value="{!agreement.ActionCode__c}" rendered="{!mode == ''}" />   
                </apex:outputPanel>                        
            </apex:pageBlockSectionItem>
                
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Invoice_Limit}"/>
                <apex:outputPanel >
                        <apex:inputField value="{!agreement.InvoiceLimitFlag__c}" rendered="{!mode != ''}"/>  
                        <apex:outputField value="{!agreement.InvoiceLimitFlag__c}" rendered="{!mode == ''}"/>                 
                </apex:outputPanel>     
            </apex:pageBlockSectionItem>    

            <apex:pageBlockSectionItem helpText="{!$ObjectType.Agreement__c.Fields.PotentialPerformanceBonus__c.inlineHelpText}">
                    <apex:outputText value="{!$Label.Potential_Performance_Bonus}"/>
                    <apex:outputPanel >
                        <apex:inputField value="{!agreement.PotentialPerformanceBonus__c}" rendered="{!mode != ''}"/>  
                        <apex:outputField value="{!agreement.PotentialPerformanceBonus__c}" rendered="{!mode == ''}"/> 
                    </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem > 
                <apex:outputText value="{!$Label.Description}"/> 
                <apex:outputPanel >
                <apex:inputField value="{!agreement.Description__c}" rendered="{!mode != ''}"/>  
                <apex:outputField value="{!agreement.Description__c}" rendered="{!mode == ''}"/>                 
                </apex:outputPanel>   
            </apex:pageBlockSectionItem>
                                                                                                                                              
        </apex:pageBlockSection>


        <apex:pageBlockSection collapsible="false" columns="1">
            <apex:pageBlockSectionItem helpText="{!$ObjectType.Agreement__c.Fields.FinancialComments__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Financial_Comments}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FinancialComments__c}" rendered="{!mode != ''}" style="width: 780px"/>  
                    <apex:outputField value="{!agreement.FinancialComments__c}" rendered="{!mode == ''}" style="width: 780px"/> 
                </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem> 
        </apex:pageBlockSection>
        
        <apex:pageBlockSection columns="1">
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ScopePackage__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Scope_Package_Field_Label}"/>
                <apex:outputPanel >
                    <!--<apex:inputField value="{!agreement.ScopePackage__c}" onChange="primeScopeChanged();" rendered="{!mode != ''}"/>-->
                     <apex:inputField value="{!agreement.ScopePackage__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ScopePackage__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>    
                
            <apex:pageBlockSectionItem helptext="{!$Label.Scope_of_Services_Message}">
                <apex:outputText value="{!$Label.Scope_of_Services}"/>
                <apex:outputPanel id="primeScope">
                    <apex:inputField style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode != ''}"/>               
                    <apex:outputField style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode == ''}"/>
                    <!--<apex:outputField style="width: 780px" value="{!agreement.ScopePackage__r.Scope_Details__c}" rendered="{!agreement.ScopePackage__c != null}"/>-->
                </apex:outputPanel>             
            </apex:pageBlockSectionItem>    
        </apex:pageBlockSection>        
        </apex:pageBlock>
        <apex:inputHidden value="{!projectFundingId}" id="testfunding"/>
        <apex:actionFunction name="manageFundingProjectLevel" id="manageFundingProjectLevel" action="{!manageFundingByProject}" rerender="testfunding">
            <apex:param id="projId" name="fundingProjectId" value="" assignTo="{!projectFundingId}"/>
        </apex:actionFunction>        
        
        <apex:pageBlock title="{!$Label.Funding}" rendered="{!mode == ''}">       
            <apex:pageBlockButtons location="top"><apex:commandButton value="{!$Label.Manage_Funding}" action="{!manageFunding}"  immediate="true"/></apex:pageBlockButtons>
            <apex:outputPanel id="fundingPanel" rendered="{!projects.size == 1}">
            <apex:outputPanel rendered="{!fundings != null && fundings.size > 0}">
            <apex:pageBlockTable value="{!fundings}" var="funding">
                <apex:column headervalue="{!$Label.Date_Allocated}">
                    <apex:outputField value="{!funding.CreatedDate}" rendered="{!funding.DateAllocatedDate__c == null}"></apex:outputField>
                    <apex:outputField value="{!funding.DateAllocatedDate__c}" rendered="{!funding.DateAllocatedDate__c != null}"></apex:outputField>                    
                </apex:column>             
                <apex:column headervalue="{!$Label.Classification}">
                    <apex:outputField value="{!funding.FundingClassification__c}"/>
                </apex:column>      
                <apex:column headervalue="{!$Label.Allocated_Amount}">
                    <apex:outputField value="{!funding.TotalBaselinedAmount__c}" rendered="{!funding.AllocatedAmount__c==null}"/>
                    <apex:outputField value="{!funding.AllocatedAmount__c}" rendered="{!funding.AllocatedAmount__c!=null}"/>
                </apex:column>
        </apex:pageBlockTable>   
        </apex:outputPanel>
        </apex:outputPanel>

        <apex:outputPanel rendered="{!fundings.size == 0}">
            <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
        </apex:outputPanel> 
        </apex:pageBlock>     

        <apex:pageBlock title="{!$Label.Contract_Reviews}" rendered="{!mode == ''}">
        <apex:outputPanel rendered="{!contractReviews != null && contractReviews.size > 0}">
            <apex:pageBlockTable value="{!contractReviews}" var="contractReview">
    
                <apex:column headervalue="{!$Label.Contract_Review_Id}">
                    <apex:commandlink action="{!URLFOR($Action.Contract_Review__c.view, contractReview.Id)}"><apex:outputField value="{!contractReview.Name}"/></apex:commandLink>
                </apex:column>          

                <apex:column headervalue="{!$Label.Review_Status}">
                    <apex:outputField value="{!contractReview.Status_Review__c}"/>
                </apex:column>    
                <apex:column headervalue="{!$Label.Review_Request_Type}">
                    <apex:outputField value="{!contractReview.Review_Request_Type__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Opportunity_Name}">
                    <apex:outputField value="{!contractReview.Opportunity_Name__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Date_Review_is_Required}">
                    <apex:outputField value="{!contractReview.Date_Required__c}"/>
                </apex:column>                                  
                <apex:column headervalue="{!$Label.Client_Vendor}">
                    <apex:outputField value="{!contractReview.Client_Vendor__c}"/>
                </apex:column>  
            </apex:pageBlockTable>

        </apex:outputPanel>
        <apex:outputPanel rendered="{!contractReviews == null && contractReviews.size == 0}">
            <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
        </apex:outputPanel> 
        </apex:pageBlock> 


        <c:ECO_RiskFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="" />
        <c:ECO_AssumptionFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="Agreements" />
        <c:ECO_ProjectTeamFlyout ProjectId="{!project.Id}" rendered="{!project != null}"  />

    </apex:form>
 
    <!--<apex:relatedList list="ContractReviews__r" rendered="{!mode==''}"/>-->
    <c:ECO_GenericHistoryComponent recordLimit1="50" myObject1="{!Agreement__c}" />
    <apex:relatedList list="CombinedAttachments" rendered="{!mode == ''}" />   
    </apex:outputPanel>     

    <!-- Sub -->    
    <apex:outputPanel rendered="{!agreementRecordType =='Sub'}">
    <apex:form > 
        <!--<apex:actionFunction id="subScopeChanged" name="subScopeChanged" action="{!primeScopeChangedApex}" onComplete="window.location.reload();"/>-->

        <apex:pageBlock mode="{!pageBlockMode}" title="{!$Label.Sub_Agreement + ' ' + mode}">             
        <apex:pageBlockButtons >
            <apex:commandLink value="{!$Label.Print_Agreement}" action="{!printPdf}" styleClass="btn printAgreement" immediate="true" target="_blank" style="text-decoration:none" />
            <apex:commandButton value="{!$Label.Save}" action="{!save}" rendered="{!mode != '' && hasUpdatePermission}"/>
            <apex:commandButton value="{!$Label.Edit}" action="{!editAgreement}" rendered="{!mode == '' && hasUpdatePermission}" immediate="true"/>
            <apex:commandButton value="{!$Label.Return_to_Agreement}" action="{!cancel}" rendered="{!mode == 'Edit'}"/>           
            <apex:commandButton value="{!$Label.Initiate_Contract_Review}" action="{!initiateContractReview}" rendered="{!mode == ''}" />
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!URLFOR($Action.pse__Proj__c.view, project.Id)}" rendered="{!mode != 'New'}" immediate="true"/>

            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!cancel}" rendered="{!mode == 'New' && agreement.Project__c != null}" immediate="true"/> 
            <apex:commandButton value="{!$Label.Return_To_Project_Agreements}" action="{!returnToProjectAgreements}" rendered="{!mode == ''}" immediate="true"/>
            <apex:commandButton value="{!$Label.Delete}" rendered="{!showDeleteButton && hasUpdatePermission}" action="{!deleteAgreement}"/>
            <apex:commandButton value="{!$Label.Cancel}" action="{!cancel}" rendered="{!agreement.Project__c == null && mode =='New'}" />
        </apex:pageBlockButtons>
        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Name.inlineHelpText}">
                <apex:outputText value="{!$Label.ePM_Agreement_Number}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Name}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.Name}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Project_Name}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Project__c}" rendered="{!mode == 'New' && project == null}" required="true" />                                  
                    <apex:outputField value="{!project.Name}" rendered="{!mode == 'New' && project != null}}"/>
                    <apex:outputField value="{!agreement.Project__r.Name}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Agreement_Status}"/>
                <apex:outputPanel >
                    <apex:actionRegion >
                        <apex:inputField value="{!agreement.AgreementStatus__c}" rendered="{!mode != ''}">
                            <apex:actionSupport event="onchange" immediate="false" rerender="subExecutionDetails"/>
                        </apex:inputField>
                    </apex:actionRegion>
                    <apex:outputField value="{!agreement.AgreementStatus__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
        </apex:pageBlockSectionItem>  
            
        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Ecosystem_Project_Reference_ID_FL}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.EcoSystemReferenceNumber__c}" rendered="{!mode == 'New'}"/>
                    <apex:outputField value="{!agreement.Project__r.EcoSystemReferenceNumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ParentAgreement__c.inlineHelpText}">
                <apex:outputText value="Parent Agreement"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ParentAgreement__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ParentAgreement__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
        </apex:pageBlockSectionItem>          

        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Oracle_Project_No}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.OracleProjectnumber__c}" rendered="{!mode == 'New'}"/>
                    <apex:outputField value="{!agreement.Project__r.OracleProjectnumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.MSAReference__c.inlineHelpText}">
                <apex:outputText value="MSA Reference"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.MSAReference__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.MSAReference__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem >
        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.VendorSite__c.inlineHelpText}">
            <apex:outputText value="Sub Name"/>
            <!--<apex:outputPanel >
                <apex:inputField value="{!agreement.VendorSite__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.VendorSite__r.AccountName__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>-->
            <apex:outputPanel >
                <div class="requiredInput">
                    <div class="requiredBlock"></div>
                    <apex:selectList value="{!agreement.VendorSite__c}" multiselect="false" size="1" rendered="{!mode != ''}" styleClass="required">
                        <apex:selectOptions value="{!VendorAccounts}" />
                    </apex:selectList>
                </div>
                <apex:outputField value="{!agreement.VendorSite__r.AccountName__c}" rendered="{!mode == ''}"/>    
            </apex:outputPanel> 
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem >
        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Owner_Help_Text}">
                <apex:outputText value="{!$Label.Agreement_Owner_Label}"/>
                <apex:outputPanel >
                    <!--<apex:inputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode != ''}"  required="true"/>
                    <apex:outputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode == ''}"/>-->
                    <apex:inputField value="{!agreement.AgreementOwner__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.AgreementOwner__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>
        </apex:pageBlockSectionItem>        

    </apex:pageBlockSection>

    <apex:pageBlockSection title="{!$Label.Contract_Details}" collapsible="false">
        <apex:pageBlockSectionItem helptext="{!$Label.Type_of_Contract_Document}">
                <apex:outputText value="{!$Label.Contract_Type}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementType__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.AgreementType__c}" rendered="{!mode == ''}"/>      
                </apex:outputPanel>         
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Created_Date_Field}">
                <apex:outputText value="{!$Label.Create_Date_Field_Label}"/>
                <apex:outputField value="{!agreement.CreatedDate}"/>                
        </apex:pageBlockSectionItem>        
        
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ContractTitle__c.inlineHelpText}">
                <apex:outputText value="Contract Title/Name"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ContractTitle__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ContractTitle__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.StartDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Start_Date}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.StartDate__c}" rendered="{!mode != ''}"/>   
                    <apex:outputField value="{!agreement.StartDate__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
        </apex:pageBlockSectionItem>    
            
        <apex:pageBlockSectionItem helptext="{!$Label.Sub_Ref_Number_Help_Text}">
                <apex:outputText value="{!$Label.Vendor_Sub_Contract_Reference_No}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ClientContractReferenceNo__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ClientContractReferenceNo__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExpirationDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.End_Date_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ExpirationDate__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ExpirationDate__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>         
        </apex:pageBlockSectionItem>             
           
        <apex:pageBlockSectionItem helpText="{!$Label.Back_To_Back_with_Prime_Help_Text}">
            <apex:outputText value="{!$Label.Back_To_Back_with_Prime}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.BacktoBackwithPrime__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.BacktoBackwithPrime__c}" rendered="{!mode == ''}"/>    
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>          
        
        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Contract_Review_Status_Field_Label}"/>
                <apex:outputPanel >
                    <apex:outputText value="{!ContractReviewStatus}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>                                                 
        </apex:pageBlockSectionItem>  
    
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ProfIndemnityLiabilityAmt__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Prof_Indemnity_Liability_Amt}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ProfIndemnityLiabilityAmt__c}" rendered="{!mode != ''}"/>   
                <apex:outputField value="{!agreement.ProfIndemnityLiabilityAmt__c}" rendered="{!mode == ''}"/>  
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem >
        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.PublicGeneralLiabilityAmt__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Public_General_Liability_Amt_Field_Label}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.PublicGeneralLiabilityAmt__c}" rendered="{!mode != ''}"/>   
                <apex:outputField value="{!agreement.PublicGeneralLiabilityAmt__c}" rendered="{!mode == ''}"/>      
            </apex:outputPanel>     
        </apex:pageBlockSectionItem>          

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ContractTypeComments__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Contract_Type_Comments}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ContractTypeComments__c}" rendered="{!mode != ''}"/>               
                <apex:outputField value="{!agreement.ContractTypeComments__c}" rendered="{!mode == ''}"/>      
            </apex:outputPanel>     
        </apex:pageBlockSectionItem>

    </apex:pageBlockSection>

    <apex:pageBlockSection columns="1">
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ScopePackage__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Scope_Package_Field_Label}"/>
            <apex:outputPanel >
                <!--<apex:inputField value="{!agreement.ScopePackage__c}" onChange="subScopeChanged();" rendered="{!mode != ''}"/>-->
                <apex:inputField value="{!agreement.ScopePackage__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.ScopePackage__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>    
                
        <apex:pageBlockSectionItem helptext="{!$Label.Scope_of_Services_Message}">
            <apex:outputText value="{!$Label.Scope_of_Services}"/>
            <apex:outputPanel id="subScope">
                <apex:inputField style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode != ''}"/>   
                <apex:outputField style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode == ''}"/>
                <!--<apex:outputField style="width: 780px" value="{!agreement.ScopePackage__r.Scope_Details__c}" rendered="{!agreement.ScopePackage__c != null}"/>  -->        
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>                                  
                                                                                                                            
    </apex:pageBlockSection>

    <apex:pageBlockSection title="{!$Label.Agreement_Currency_Note}" collapsible="false">

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FeeType__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Fee_Type}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.FeeType__c}" rendered="{!mode != ''}" required="false"/>
                <apex:outputField value="{!agreement.FeeType__c}" rendered="{!mode == ''}"/>        
            </apex:outputPanel>     
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem >
            <apex:outputText value="{!$Label.Payment_Terms_Field_Label}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.PaymentTerms__c}" rendered="{!mode != ''}" required="false"/>                  
                <apex:outputField value="{!agreement.PaymentTerms__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>    
        </apex:pageBlockSectionItem>    

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FundingCurrencyCode__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Currency}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode != ''}" required="false"/>
                <apex:outputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>   

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementAmountEstimated__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Amount_Estimated}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode != ''}"/>    
                    <apex:outputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode == ''}"/>   
                </apex:outputPanel>         
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Total_Purchase_Orders_Raised}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>             
        </apex:pageBlockSectionItem>    

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Amount__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Confirmed_And_Committed_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Amount__c}" rendered="{!mode != ''}" />
                    <apex:outputField value="{!agreement.Amount__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>             
        </apex:pageBlockSectionItem>     

        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Total_Invoiced_FL}"/>
                <apex:outputField value="{!agreement.Total_Invoiced__c}"/>              
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem >
            <apex:outputPanel />
        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Total_Paid_FL}" />
                <apex:outputField value="{!agreement.TotalPaid__c}" />              
        </apex:pageBlockSectionItem>          
                         
    </apex:pageBlockSection>


    <apex:pageBlockSection title="{!$Label.Agreement_Execution_Details}" collapsible="false" id="subExecutionDetails">

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c == 'Executed'}"/>
                <apex:outputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>   

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExecutionDate__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Execution_Date}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ExecutionDate__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c == 'Executed'}"/>
                <apex:outputField value="{!agreement.ExecutionDate__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy2__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>  

    </apex:pageBlockSection>

</apex:pageBlock>   
        
        <apex:pageBlock title="{!$Label.Contract_Reviews}" rendered="{!mode == ''}">
        <apex:outputPanel rendered="{!contractReviews != null && contractReviews.size > 0}">
            <apex:pageBlockTable value="{!contractReviews}" var="contractReview">
    
                <apex:column headervalue="{!$Label.Contract_Review_Id}">
                    <apex:commandlink action="{!URLFOR($Action.Contract_Review__c.view, contractReview.Id)}"><apex:outputField value="{!contractReview.Name}"/></apex:commandLink>
                </apex:column>          

                <apex:column headervalue="{!$Label.Review_Status}">
                    <apex:outputField value="{!contractReview.Status_Review__c}"/>
                </apex:column>    
                <apex:column headervalue="{!$Label.Review_Request_Type}">
                    <apex:outputField value="{!contractReview.Review_Request_Type__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Opportunity_Name}">
                    <apex:outputField value="{!contractReview.Opportunity_Name__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Date_Review_is_Required}">
                    <apex:outputField value="{!contractReview.Date_Required__c}"/>
                </apex:column>                                  
                <apex:column headervalue="{!$Label.Client_Vendor}">
                    <apex:outputField value="{!contractReview.Client_Vendor__c}"/>
                </apex:column>  
            </apex:pageBlockTable>

        </apex:outputPanel>
        <apex:outputPanel rendered="{!contractReviews != null &&  contractReviews.size == 0}">
            <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
        </apex:outputPanel> 
        </apex:pageBlock> 

        <!-- <c:ECO_MSAFlyout MSAId="{!agreement.MSAReference__c}" rendered="{!agreement.MSAReference__c != null}"/>  -->
        <c:ECO_RiskFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="" />
        <c:ECO_AssumptionFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="Agreements" />
        <c:ECO_ProjectTeamFlyout ProjectId="{!project.Id}" rendered="{!project != null}"  />
        <apex:pageBlock title="{!$Label.Purchase_Orders}" rendered="{!mode == ''}">
            <apex:pageBlockButtons location="top"><apex:commandButton value="{!$Label.New_Purchase_Order}" action="{!newPurchaseOrder}"/></apex:pageBlockButtons>
            <apex:pageBlockTable value="{!PurchaseOrders}" var="po" rendered="{!PurchaseOrders != null}">
                <apex:column style="width:60px" headervalue="{!$Label.ECO_Action}">
                    <apex:commandLink style="color:#015ba7;" action="{!URLFOR($Action.POHeader__c.edit, po.Id, ['retURL'='/apex/ECO_AgreementView?id='&agreement.Id])}">{!$Label.Edit}</apex:commandLink><apex:outputText value=" | "/>
                    <apex:commandLink style="color:#015ba7;" action="{!URLFOR($Action.POHeader__c.delete, po.Id, ['retURL'='/apex/ECO_AgreementView?id='&agreement.Id])}" onclick="return window.confirm('{!$Label.Are_you_sure}');">{!$Label.Del}</apex:commandLink>
                </apex:column>
                <apex:column headervalue="{!$Label.Purchase_Order_Number}">
                    <apex:commandLink action="{!URLFOR($Action.POHeader__c.view, po.Id, ['retURL'='/apex/ECO_AgreementView?id='&agreement.Id])}">
                        <apex:outputField value="{!po.Name}"/>
                    </apex:commandLink> </apex:column>              
                <apex:column headervalue="{!$Label.Project}"><apex:outputField value="{!po.Project__c}"/></apex:column>               
                <apex:column headervalue="{!$Label.PO_Date}"><apex:outputField value="{!po.PO_Date__c}"/></apex:column>                
                <apex:column headervalue="{!$Label.PO_Type}"><apex:outputField value="{!po.POType__c}"/></apex:column>                
                <apex:column headervalue="{!$Label.Requestor}"><apex:outputField value="{!po.Requestor__c}"/></apex:column>               
                <apex:column headervalue="{!$Label.Status}"><apex:outputField value="{!po.Status__c}"/></apex:column>             
                <apex:column headervalue="{!$Label.Total}"><apex:outputField value="{!po.Total__c}"/></apex:column>               
                <apex:column headervalue="{!$Label.Created_Date}"><apex:outputField value="{!po.CreatedDate}"/></apex:column>             
                <apex:column headervalue="{!$Label.Created_By}"><apex:outputField value="{!po.CreatedById}"/></apex:column>               

            </apex:pageBlockTable>
            <apex:outputPanel rendered="{!PurchaseOrders == null}">
                <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
            </apex:outputPanel> 
        </apex:pageBlock>
    </apex:form>
    
    <!--<apex:relatedList list="ContractReviews__r" rendered="{!mode==''}"/>-->
    <c:ECO_GenericHistoryComponent recordLimit1="50" myObject1="{!Agreement__c}" />
    <apex:relatedList list="CombinedAttachments" rendered="{!mode==''}"/>
    
    </apex:outputPanel> 
    
    <!-- Inter-Company -->  
    <apex:outputPanel rendered="{!agreementRecordType =='InterCompany'}">
    <apex:form > 
        <apex:actionFunction id="subScopeChanged" name="subScopeChanged" rerender="subScope"/>

        <apex:pageBlock mode="{!pageBlockMode}" title="{!$Label.Inter_Company_Agreement + ' ' + mode}">              
        <apex:pageBlockButtons >
            <apex:commandLink value="{!$Label.Print_Agreement}" action="{!printPdf}" styleClass="btn printAgreement" immediate="true" target="_blank" style="text-decoration:none" />
            <apex:commandButton value="{!$Label.Save}" action="{!save}" rendered="{!mode != '' && hasUpdatePermission}"/>
            <apex:commandButton value="{!$Label.Edit}" action="{!editAgreement}" rendered="{!mode == '' && hasUpdatePermission}" immediate="true"/>
            <apex:commandButton value="{!$Label.Return_to_Agreement}" action="{!cancel}" rendered="{!mode == 'Edit'}"/>           
            <apex:commandButton value="{!$Label.Initiate_Contract_Review}" action="{!initiateContractReview}" rendered="{!mode == ''}" />
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!cancel}" rendered="{!mode == 'New' && agreement.Project__c != null}"  immediate="true"/>  
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!URLFOR($Action.pse__Proj__c.view, project.Id)}" rendered="{!mode != 'New'}" immediate="true"/>
            <apex:commandButton value="{!$Label.Return_To_Project_Agreements}" action="{!returnToProjectAgreements}" rendered="{!mode == ''}" immediate="true" />
            <apex:commandButton value="{!$Label.Delete}" rendered="{!showDeleteButton && hasUpdatePermission}" action="{!deleteAgreement}"/>
            <apex:commandButton value="{!$Label.Cancel}" action="{!cancel}" rendered="{!agreement.Project__c == null && mode =='New'}" />
        </apex:pageBlockButtons>
        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Name.inlineHelpText}">
                <apex:outputText value="{!$Label.ePM_Agreement_Number}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Name}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.Name}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Project_Name}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Project__c}" rendered="{!mode == 'New' && project == null}" required="true"/>               
                    <apex:outputField value="{!project.Name}" rendered="{!mode == 'New' && project != null}"/>
                    <apex:outputField value="{!agreement.Project__r.Name}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Agreement_Status}"/>
                <apex:outputPanel >
                    <apex:actionRegion >
                        <apex:inputField value="{!agreement.AgreementStatus__c}" rendered="{!mode != ''}">
                            <apex:actionSupport event="onchange" immediate="false" rerender="interimExecutionDetails"/>
                        </apex:inputField>
                    </apex:actionRegion>    
                    <apex:outputField value="{!agreement.AgreementStatus__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>   

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Ecosystem_Project_Reference_ID_FL}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.EcoSystemReferenceNumber__c}" rendered="{!mode == 'New'}"/>
                    <apex:outputField value="{!agreement.Project__r.EcoSystemReferenceNumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$Label.Prime_Agreement_Help_Text}">
                <apex:outputText value="{!$Label.Prime_Agreement_FL}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ParentAgreement__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ParentAgreement__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>  
  
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Oracle_Project_No}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.OracleProjectnumber__c}" rendered="{!mode == 'New'}"/>
                    <apex:outputField value="{!agreement.Project__r.OracleProjectnumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>  

             <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Owner_Help_Text}">
                <apex:outputText value="{!$Label.Agreement_Owner_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementOwner__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.AgreementOwner__c}" rendered="{!mode == ''}"/>  
                    <!--<apex:inputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode != ''}"  required="true"/>
                    <apex:outputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode == ''}"/>-->
                </apex:outputPanel>
            </apex:pageBlockSectionItem>              

            <apex:pageBlockSectionItem >
            </apex:pageBlockSectionItem>

        </apex:pageBlockSection>

        <apex:pageBlockSection title="{!$Label.Contract_Details}" collapsible="false">  

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.IntercompanySubconsultant__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Intercompany_Subconsultant}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.IntercompanySubconsultant__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.IntercompanySubconsultant__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>               

            <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Created_Date_Field}">
                <apex:outputText value="{!$Label.Create_Date_Field_Label}"/>
                <apex:outputField value="{!agreement.CreatedDate}"/>                
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Intercompany_Project__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Inter_Company_Project}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Intercompany_Project__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.Intercompany_Project__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>            

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.StartDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Start_Date}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.StartDate__c}" rendered="{!mode != ''}"/>   
                    <apex:outputField value="{!agreement.StartDate__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>   

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Back_To_Back_with_Prime}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.BacktoBackwithPrime__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.BacktoBackwithPrime__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>  

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExpirationDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.End_Date_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ExpirationDate__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ExpirationDate__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>  
         
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.TeamLeaderName__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Team_Leader_Name}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.TeamLeaderName__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.TeamLeaderName__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Contract_Review_Status_Field_Label}"/>
                <apex:outputPanel >
                    <apex:outputText value="{!ContractReviewStatus}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Team_Leader_Title}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.TeamLeaderTitle__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.TeamLeaderTitle__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>   

            <apex:pageBlockSectionItem >
            </apex:pageBlockSectionItem>


    </apex:pageBlockSection>

    <apex:pageBlockSection title="{!$Label.Agreement_Currency_Note}" collapsible="false">      
            <apex:pageBlockSectionItem helptext="{!$Label.Feet_Type_Help_Text}" >
                <apex:outputText value="Interco Fee Type"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FeeType__c}" rendered="{!mode != ''}" required="false"/>
                    <apex:outputField value="{!agreement.FeeType__c}" rendered="{!mode == ''}"/>        
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helpText="{!$Label.Total_Amount_of_Revenue_Message}" >
            <apex:outputText value="{!$Label.Total_Approved_Revenue_Limit}"/>
            <apex:outputPanel id="totalApprovedRevenueLimit">
                <apex:outputPanel >
                        <apex:inputField value="{!agreement.TotalApprovedRevenueLimit__c}" rendered="{!mode != ''}" />
                    <apex:outputField value="{!agreement.TotalApprovedRevenueLimit__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="">
                <apex:outputText value="{!$Label.Payment_Terms_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.PaymentTerms__c}" rendered="{!mode != ''}" required="false">
                    </apex:inputField>
                    <apex:outputField value="{!agreement.PaymentTerms__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>  
 
            <apex:pageBlockSectionItem helptext="{!$Label.Variance_Between_Approved_and_Confirmed}">
                <apex:outputText value="{!$Label.Variance_Field_Label}"/>
                <apex:outputField value="{!agreement.AgreementVariance__c}"/>                
            </apex:pageBlockSectionItem>  

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FundingCurrencyCode__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Currency}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode != ''}" required="false"/>
                    <apex:outputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>       


            <apex:pageBlockSectionItem helpText="{!$Label.Pick_Variance_Reason}">
                <apex:outputText value="{!$Label.Variance_Reason_Field_Label}"/>
                <apex:outputPanel >
                        <apex:inputField value="{!agreement.VarianceReason__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.VarianceReason__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem>  

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementAmountEstimated__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Amount_Estimated}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode != ''}"/>    
                    <apex:outputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode == ''}"/>   
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>            

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Purchase_Order_only_applicable_if_not_using_Cross_Charging}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>             
            </apex:pageBlockSectionItem>  

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Amount__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Confirmed_And_Committed_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Amount__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.Amount__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>             
            </apex:pageBlockSectionItem>            
        
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Total_Purchase_Orders_Raised}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>             
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem >
                <apex:outputPanel />
            </apex:pageBlockSectionItem>
                         
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Total_Invoiced_FL}"/>
                <apex:outputField value="{!agreement.Total_Invoiced__c}"/>              
            </apex:pageBlockSectionItem>            

            <apex:pageBlockSectionItem helptext="">
                <apex:outputPanel />
            </apex:pageBlockSectionItem>            
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Total_Paid_FL}" />
                <apex:outputField value="{!agreement.TotalPaid__c}" />              
            </apex:pageBlockSectionItem>        
                 
            </apex:pageBlockSection>

    <apex:pageBlockSection title="{!$Label.Execution_Details}" collapsible="false" id="interimExecutionDetails">
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c == 'Executed'}"/>
                <apex:outputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExecutionDate__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Execution_Date}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ExecutionDate__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c == 'Executed'}"/>
                <apex:outputField value="{!agreement.ExecutionDate__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>   

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy2__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>                

    </apex:pageBlockSection>
            
            <apex:pageBlockSection columns="1" title="{!$Label.General_Conditions_Header}">
            <div class="infoTable">
                <table  border="1" cellpadding="0" cellspacing="0">
                    <TR><TD><b>{!$Label.Inter_Company_Header_1}</b><br/>{!$Label.Inter_Company_Detail_1}</TD></TR>
                    <TR><TD><b>{!$Label.Inter_Company_Header_2}</b><br/>{!$Label.Inter_Company_Detail_2}</TD></TR>
                    <TR><TD><b>{!$Label.Inter_Company_Header_3}</b><br/>{!$Label.Inter_Company_Detail_3}</TD></TR>
                    <TR><TD><b>{!$Label.Inter_Company_Header_4}</b><br/>{!$Label.Inter_Company_Detail_4}</TD></TR>
                    <TR><TD><b>{!$Label.Inter_Company_Header_5}</b><br/>{!$Label.Inter_Company_Detail_5}</TD></TR>           
                </table>
            </div>          
            </apex:pageBlockSection>
            
            <apex:pageBlockSection columns="1" title="{!$Label.Section_A_Title}">
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ScopePackage__c.inlineHelpText}">
                    <apex:outputText value="{!$Label.Scope_Package_Field_Label}"/>
                    <apex:outputPanel >
                        <!--<apex:inputField value="{!agreement.ScopePackage__c}" onChange="subScopeChanged();" rendered="{!mode != ''}"/>-->
                        <apex:inputField value="{!agreement.ScopePackage__c}"  rendered="{!mode != ''}"/>
                        <apex:outputField value="{!agreement.ScopePackage__c}" rendered="{!mode == ''}"/>
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>    
                
                <apex:pageBlockSectionItem helptext="{!$Label.Scope_of_Services_Message}">
                    <apex:outputText value="{!$Label.Scope_of_Services}"/>
                    <apex:outputPanel id="subScope">
                        <apex:inputField style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode != ''}"/>   
                        <apex:outputField style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode == ''}"/>
                        <!--<apex:outputField style="width: 780px" value="{!agreement.ScopePackage__r.Scope_Details__c}" rendered="{!agreement.ScopePackage__c != null}"/> -->         
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>                                 
                                                                                                                            
            </apex:pageBlockSection>
            
            <apex:pageBlockSection columns="1" title="{!$Label.Section_B_Title}">
                    <apex:pageblockSectionItem >
                        <apex:outputText value="{!$Label.Transfer_Policy}"/>
                        <apex:outputPanel >
                        <apex:inputField value="{!agreement.CommericialTerms__c}" rendered="{!mode != ''}"/>
                        <apex:outputField value="{!agreement.CommericialTerms__c}" rendered="{!mode == ''}" />
                        </apex:outputPanel>                     
                    </apex:pageblockSectionItem>
                    <apex:pageblockSectionItem >
                        <apex:outputText value="{!$Label.Other_please_describe_below}"/>
                        <apex:outputPanel >                     
                        <apex:inputField value="{!agreement.CommericialTermsOther__c}" rendered="{!mode != ''}"/>
                        <apex:outputField value="{!agreement.CommericialTermsOther__c}" rendered="{!mode == ''}"/>   
                        </apex:outputPanel>
                    </apex:pageblockSectionItem>
                    <apex:pageblockSectionItem >
                        <apex:outputPanel >
                            <apex:inputField style="width: 780px" value="{!agreement.CommericialTermsDescription__c}" rendered="{!mode != ''}"/>
                            <apex:outputField style="width: 780px" value="{!agreement.CommericialTermsDescription__c}" rendered="{!mode == ''}"/>                       
                        </apex:outputPanel>
                    </apex:pageblockSectionItem>    
            </apex:pageBlockSection>
            
            <apex:pageBlockSection columns="1" title="{!$Label.Section_C_Title}">   
                <apex:outputPanel >       
                <apex:inputField style="width: 780px" value="{!agreement.SpecialConditions__c}" rendered="{!mode != ''}"/>
                <apex:outputField style="width: 780px" value="{!agreement.SpecialConditions__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>                 
            </apex:pageBlockSection>
        
        </apex:pageBlock>  
        <apex:pageBlock title="{!$Label.Purchase_Orders}" rendered="{!mode == ''}">
            <apex:pageBlockButtons location="top"><apex:commandButton value="{!$Label.New_Purchase_Order}" action="{!newPurchaseOrder}"/></apex:pageBlockButtons>
            <apex:pageBlockTable value="{!PurchaseOrders}" var="po" rendered="{!PurchaseOrders != null}">
                <apex:column style="width:60px" headervalue="{!$Label.ECO_Action}">
                    <apex:commandLink style="color:#015ba7;" action="{!URLFOR($Action.POHeader__c.edit, po.Id, ['retURL'='/apex/ECO_AgreementView?id='&agreement.Id])}">{!$Label.Edit}</apex:commandLink><apex:outputText value=" | "/>
                    <apex:commandLink style="color:#015ba7;" action="{!URLFOR($Action.POHeader__c.delete, po.Id, ['retURL'='/apex/ECO_AgreementView?id='&agreement.Id])}" onclick="return window.confirm('{!$Label.Are_you_sure}?');">{!$Label.Del}</apex:commandLink>
                </apex:column>
                <apex:column headervalue="{!$Label.Purchase_Order_Number}">
                    <apex:commandLink action="{!URLFOR($Action.POHeader__c.view, po.Id, ['retURL'='/apex/ECO_AgreementView?id='&agreement.Id])}">
                        <apex:outputField value="{!po.Name}"/>
                    </apex:commandLink> </apex:column>              
                <apex:column headervalue="{!$Label.Project}"><apex:outputField value="{!po.Project__c}"/></apex:column>               
                <apex:column headervalue="{!$Label.PO_Date}"><apex:outputField value="{!po.PO_Date__c}"/></apex:column>                
                <apex:column headervalue="{!$Label.PO_Type}"><apex:outputField value="{!po.POType__c}"/></apex:column>                
                <apex:column headervalue="{!$Label.Requestor}"><apex:outputField value="{!po.Requestor__c}"/></apex:column>               
                <apex:column headervalue="{!$Label.Status}"><apex:outputField value="{!po.Status__c}"/></apex:column>             
                <apex:column headervalue="{!$Label.Total}"><apex:outputField value="{!po.Total__c}"/></apex:column>               
                <apex:column headervalue="{!$Label.Created_Date}"><apex:outputField value="{!po.CreatedDate}"/></apex:column>             
                <apex:column headervalue="{!$Label.Created_By}"><apex:outputField value="{!po.CreatedById}"/></apex:column>               

            </apex:pageBlockTable>
            <apex:outputPanel rendered="{!PurchaseOrders == null}">
                <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
            </apex:outputPanel> 
        </apex:pageBlock>
        <apex:pageBlock title="{!$Label.Contract_Reviews}" rendered="{!mode == ''}">
        <apex:outputPanel rendered="{!contractReviews != null && contractReviews.size > 0}">
            <apex:pageBlockTable value="{!contractReviews}" var="contractReview">
    
                <apex:column headervalue="{!$Label.Contract_Review_Id}">
                    <apex:commandlink action="{!URLFOR($Action.Contract_Review__c.view, contractReview.Id)}"><apex:outputField value="{!contractReview.Name}"/></apex:commandLink>
                </apex:column>          

                <apex:column headervalue="{!$Label.Review_Status}">
                    <apex:outputField value="{!contractReview.Status_Review__c}"/>
                </apex:column>    
                <apex:column headervalue="{!$Label.Review_Request_Type}">
                    <apex:outputField value="{!contractReview.Review_Request_Type__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Opportunity_Name}">
                    <apex:outputField value="{!contractReview.Opportunity_Name__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Date_Review_is_Required}">
                    <apex:outputField value="{!contractReview.Date_Required__c}"/>
                </apex:column>                                  
                <apex:column headervalue="{!$Label.Client_Vendor}">
                    <apex:outputField value="{!contractReview.Client_Vendor__c}"/>
                </apex:column>  
            </apex:pageBlockTable>

        </apex:outputPanel>
        <apex:outputPanel rendered="{!contractReviews == null && contractReviews.size == 0}">
            <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
        </apex:outputPanel> 
        </apex:pageBlock>          
      <!--   <c:ECO_MSAFlyout MSAId="{!agreement.MSAReference__c}" rendered="{!agreement.MSAReference__c != null}"/>  -->
        <c:ECO_RiskFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="" />
        <c:ECO_AssumptionFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="Agreements" />
        <c:ECO_ProjectTeamFlyout ProjectId="{!project.Id}" rendered="{!project != null}"  />
    </apex:form>
    <!--<apex:relatedList list="ContractReviews__r" rendered="{!mode==''}"/>-->
    <c:ECO_GenericHistoryComponent recordLimit1="50" myObject1="{!Agreement__c}" />
    <apex:relatedList list="CombinedAttachments" rendered="{!mode==''}"/>
    
    </apex:outputPanel>     

<!--                    JointVenture                               -->
    <apex:outputPanel rendered="{!agreementRecordType == 'JointVenture'}">
    <apex:form > 
        <apex:actionFunction id="subScopeChanged" name="subScopeChanged" rerender="subScope"/>

        <apex:pageBlock mode="{!pageBlockMode}" title="{!$Label.Joint_Venture_Agreement + ' ' + mode}">              
        <apex:pageBlockButtons >
            <apex:commandLink value="{!$Label.Print_Agreement}" action="{!printPdf}" styleClass="btn printAgreement" immediate="true" target="_blank" style="text-decoration:none" />
            <apex:commandButton value="{!$Label.Save}" action="{!save}" rendered="{!mode != '' && hasUpdatePermission}"/>
            <apex:commandButton value="{!$Label.Edit}" action="{!editAgreement}" rendered="{!mode == '' && hasUpdatePermission}" immediate="true"/>
            <apex:commandButton value="{!$Label.Return_to_Agreement}" action="{!cancel}" rendered="{!mode == 'Edit'}"/>           
            <apex:commandButton value="{!$Label.Initiate_Contract_Review}" action="{!initiateContractReview}" rendered="{!mode == ''}" />
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!cancel}" rendered="{!mode == 'New' && agreement.Project__c != null}"  immediate="true"/>  
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!URLFOR($Action.pse__Proj__c.view, project.Id)}" rendered="{!mode != 'New'}" immediate="true"/>
            <apex:commandButton value="{!$Label.Return_To_Project_Agreements}" action="{!returnToProjectAgreements}" rendered="{!mode == ''}" immediate="true"/>
            <apex:commandButton value="{!$Label.Delete}" rendered="{!showDeleteButton  && hasUpdatePermission}" action="{!deleteAgreement}"/>
            <apex:commandButton value="{!$Label.Cancel}" action="{!cancel}" rendered="{!agreement.Project__c == null && mode =='New'}" />
        </apex:pageBlockButtons>
        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Name.inlineHelpText}">
                <apex:outputText value="{!$Label.ePM_Agreement_Number}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Name}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.Name}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Project_Name}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Project__c}" rendered="{!mode == 'New' && project == null}" required="true"/>               
                    <apex:outputField value="{!project.Name}" rendered="{!mode == 'New' && project != null}"/>
                    <apex:outputField value="{!agreement.Project__r.Name}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Agreement_Status}"/>
                <apex:outputPanel >
                    <apex:actionRegion >
                        <apex:inputField value="{!agreement.AgreementStatus__c}" rendered="{!mode != ''}">
                            <apex:actionSupport event="onchange" immediate="false" rerender="jointExecutionDetails"/>
                        </apex:inputField>
                    </apex:actionRegion>
                    <apex:outputField value="{!agreement.AgreementStatus__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>   

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Ecosystem_Project_Reference_ID_FL}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.EcoSystemReferenceNumber__c}" rendered="{!mode == 'New'}"/>
                    <apex:outputField value="{!agreement.Project__r.EcoSystemReferenceNumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

             <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Owner_Help_Text}">
                <apex:outputText value="{!$Label.Agreement_Owner_Label}"/>
                <apex:outputPanel >
                    <!--<apex:inputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode != ''}"  required="true"/>
                    <apex:outputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode == ''}"/>-->
                    <apex:inputField value="{!agreement.AgreementOwner__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.AgreementOwner__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>
            </apex:pageBlockSectionItem>              
  
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Oracle_Project_No}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.OracleProjectnumber__c}" rendered="{!mode == 'New'}"/>
                    <apex:outputField value="{!agreement.Project__r.OracleProjectnumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>  

        </apex:pageBlockSection>

        <apex:pageBlockSection title="{!$Label.Contract_Details}" collapsible="false">  

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.JointVenturePartner__c.inlineHelpText}">
                <apex:outputText value="Joint Venture Partner"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.JointVenturePartner__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.JointVenturePartner__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>               

            <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Created_Date_Field}">
                <apex:outputText value="{!$Label.Create_Date_Field_Label}"/>
                <apex:outputField value="{!agreement.CreatedDate}"/>                
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem >
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.StartDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Start_Date}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.StartDate__c}" rendered="{!mode != ''}"/>   
                    <apex:outputField value="{!agreement.StartDate__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>   

            <apex:pageBlockSectionItem >
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExpirationDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.End_Date_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ExpirationDate__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ExpirationDate__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>  

            <apex:pageBlockSectionItem >
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Contract_Review_Status_Field_Label}"/>
                <apex:outputPanel >
                    <apex:outputText value="{!ContractReviewStatus}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem> 

    </apex:pageBlockSection>

    <apex:pageBlockSection title="{!$Label.Agreement_Currency_Note}" collapsible="false">      
            <apex:pageBlockSectionItem helptext="{!$Label.Feet_Type_Help_Text}" >
                <apex:outputText value="{!$Label.Fee_Type}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FeeType__c}" rendered="{!mode != ''}" required="false"/>
                    <apex:outputField value="{!agreement.FeeType__c}" rendered="{!mode == ''}"/>        
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helpText="{!$Label.Total_Amount_of_Revenue_Message}" >
            <apex:outputText value="{!$Label.Total_Approved_Revenue_Limit}"/>
            <apex:outputPanel id="totalApprovedRevenueLimit">
                <apex:outputPanel >
                        <apex:inputField value="{!agreement.TotalApprovedRevenueLimit__c}" rendered="{!mode != ''}" />
                    <apex:outputField value="{!agreement.TotalApprovedRevenueLimit__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="">
                <apex:outputText value="{!$Label.Payment_Terms_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.PaymentTerms__c}" rendered="{!mode != ''}" required="false">
                    </apex:inputField>
                    <apex:outputField value="{!agreement.PaymentTerms__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>                     

            <apex:pageBlockSectionItem helptext="{!$Label.Variance_Between_Approved_and_Confirmed}">
                <apex:outputText value="{!$Label.Variance_Field_Label}"/>
                <apex:outputField value="{!agreement.AgreementVariance__c}"/>                
            </apex:pageBlockSectionItem>            

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FundingCurrencyCode__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Currency}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode != ''}" required="false"/>
                    <apex:outputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>            
            
             <apex:pageBlockSectionItem helpText="{!$Label.Pick_Variance_Reason}">
                <apex:outputText value="{!$Label.Variance_Reason_Field_Label}"/>
                <apex:outputPanel >
                        <apex:inputField value="{!agreement.VarianceReason__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.VarianceReason__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem> 
        
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementAmountEstimated__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Amount_Estimated}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode != ''}"/>    
                    <apex:outputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode == ''}"/>   
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>
            
            <apex:pageBlockSectionItem >
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Amount__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Confirmed_And_Committed_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Amount__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.Amount__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>             
            </apex:pageBlockSectionItem>              
                    
            </apex:pageBlockSection>

    <apex:pageBlockSection title="{!$Label.Execution_Details}" collapsible="false" id="jointExecutionDetails">
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c == 'Executed'}"/>
                <apex:outputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExecutionDate__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Execution_Date}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ExecutionDate__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c == 'Executed'}"/>
                <apex:outputField value="{!agreement.ExecutionDate__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>      

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>             

    </apex:pageBlockSection>
    </apex:pageBlock>

        <apex:pageBlock title="{!$Label.Contract_Reviews}" rendered="{!mode == ''}">
        <apex:outputPanel rendered="{!contractReviews != null && contractReviews.size > 0}">
            <apex:pageBlockTable value="{!contractReviews}" var="contractReview">
    
                <apex:column headervalue="{!$Label.Contract_Review_Id}">
                    <apex:commandlink action="{!URLFOR($Action.Contract_Review__c.view, contractReview.Id)}"><apex:outputField value="{!contractReview.Name}"/></apex:commandLink>
                </apex:column>          

                <apex:column headervalue="{!$Label.Review_Status}">
                    <apex:outputField value="{!contractReview.Status_Review__c}"/>
                </apex:column>    
                <apex:column headervalue="{!$Label.Review_Request_Type}">
                    <apex:outputField value="{!contractReview.Review_Request_Type__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Opportunity_Name}">
                    <apex:outputField value="{!contractReview.Opportunity_Name__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Date_Review_is_Required}">
                    <apex:outputField value="{!contractReview.Date_Required__c}"/>
                </apex:column>                                  
                <apex:column headervalue="{!$Label.Client_Vendor}">
                    <apex:outputField value="{!contractReview.Client_Vendor__c}"/>
                </apex:column>  
            </apex:pageBlockTable>

        </apex:outputPanel>
        <apex:outputPanel rendered="{!contractReviews == null || contractReviews.size == 0}">
            <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
        </apex:outputPanel> 
        </apex:pageBlock> 

       <c:ECO_RiskFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="" />
       <c:ECO_AssumptionFlyout ProjectId="{!project.Id}" rendered="{!project != null}" PlanElement="Agreements" />
       <c:ECO_ProjectTeamFlyout ProjectId="{!project.Id}" rendered="{!project != null}"  />
    </apex:form>
 
    <c:ECO_GenericHistoryComponent recordLimit1="50" myObject1="{!Agreement__c}" />
    <apex:relatedList list="CombinedAttachments" rendered="{!mode==''}"/>

    </apex:outputPanel>


    <!-- Prime Task Order -->   
    <apex:outputPanel rendered="{!agreementRecordType =='PrimeTaskOrder'}" id="primeTaskOrder">
    <apex:form > 
        <apex:inputHidden value="{!agreement.Project__c}"/>
        <apex:outputPanel id="msaChanged">
        <apex:inputHidden value="{!MSAChanged}"/>
        </apex:outputPanel>
        <apex:actionFunction id="subScopeChanged" name="subScopeChanged" rerender="subScope"/>

        <apex:actionFunction name="changedMSA" rerender="testPanel, msaChanged" immediate="false">
            <apex:param name="changedBool" value="" assignTo="{!MSAChanged}" />
        </apex:actionFunction>

        <apex:pageBlock mode="{!pageBlockMode}" title="{!'Prime Task Order Agreement ' + mode}">
             
        <apex:pageBlockButtons >
            <apex:commandLink value="{!$Label.Print_Agreement}" action="{!printPdf}" styleClass="btn printAgreement" immediate="true" target="_blank" style="text-decoration:none" />
            <apex:commandButton value="{!$Label.Save}" action="{!save}" rendered="{!mode != '' && hasUpdatePermission}"/>
            <apex:commandButton value="{!$Label.Edit}" action="{!editAgreement}" rendered="{!mode == '' && hasUpdatePermission}" immediate="true"/>
            <apex:commandButton value="{!$Label.Return_to_Agreement}" action="{!cancel}" rendered="{!mode == 'Edit'}"/>           
            <apex:commandButton value="{!$Label.Initiate_Contract_Review}" action="{!initiateContractReview}" rendered="{!mode == ''}" />
            <apex:commandButton value="{!$Label.Change_to_Prime}" action="{!switchToPrime}" rendered="{!mode == ''}"/>
            <apex:commandButton value="{!$Label.View_MSA}" action="{!viewMSA}" rendered="{!mode == ''}" />
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!cancel}" rendered="{!mode == 'New' && agreement.Project__c != null}" immediate="true"/>                       
            <apex:commandButton value="{!$Label.ReturnToProject}" action="{!URLFOR($Action.pse__Proj__c.view, project.Id)}" rendered="{!mode != 'New'}" immediate="true"/>
            <apex:commandButton value="{!$Label.Return_To_Project_Agreements}" action="{!returnToProjectAgreements}" rendered="{!mode == ''}" immediate="true"/>
            <apex:commandButton value="{!$Label.Delete}" rendered="{!showDeleteButton  && hasUpdatePermission}" action="{!deleteAgreement}"/>
            <apex:commandButton value="{!$Label.Cancel}" action="{!cancel}" rendered="{!agreement.Project__c == null && mode =='New'}" />
        </apex:pageBlockButtons>

        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Name.inlineHelpText}">
                <apex:outputText value="{!$Label.ePM_Agreement_Number}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Name}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.Name}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementNumber__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Oracle_Agreement_No}"/>
                <apex:outputField value="{!agreement.AgreementNumber__c}"/>
            </apex:pageBlockSectionItem>  

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Agreement_Status}"/>
                <apex:outputPanel >
                    <apex:actionRegion >
                        <apex:inputField value="{!agreement.AgreementStatus__c}" rendered="{!mode != ''}" >
                            <apex:actionSupport event="onchange" immediate="false" reRender="taskOrderExecutionDetails" />
                        </apex:inputField>
                    </apex:actionRegion>
                    <apex:outputField value="{!agreement.AgreementStatus__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>             

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Project_Name}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Project__c}" rendered="{!mode == 'New' && project == null}" required="true" />                  
                    <apex:outputField value="{!project.Name}" rendered="{!mode == 'New' && project != null}" />
                    <apex:outputField value="{!agreement.Project__r.Name}" rendered="{!mode != 'New'}"/>    
                </apex:outputPanel>         
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$Label.Search_and_select_the_MSA_that_applies_to_the_contract}">
                <apex:outputText value="{!$Label.MSA_Reference}"/>
                <apex:outputPanel id="testPanel">
                    <apex:inputField value="{!agreement.MSAReference__c}" rendered="{!mode != ''}" required="true" onchange="changedMSA('true');">
                    </apex:inputField>
                    <apex:outputField value="{!agreement.MSAReference__c}" rendered="{!mode == ''}"/>       
                </apex:outputPanel>     
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Ecosystem_Project_Reference_ID_FL}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.EcoSystemReferenceNumber__c}" rendered="{!mode == 'New'}"/>              
                    <apex:outputField value="{!agreement.Project__r.EcoSystemReferenceNumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="{!$Label.Start_and_End_Dates_of_Contract}">
                <apex:outputText value="{!$Label.MSA_Period}"/>
                <apex:outputPanel rendered="{!agreement.MSAReference__c != null}">
                    <apex:outputField value="{!agreement.MSAReference__r.OrderingPeriodStart__c}"  html-placeholder="{!$Label.Start_Date}"/>
                    <apex:outputText value=" - "/>
                    <apex:outputField value="{!agreement.MSAReference__r.OrderingPeriodEnd__c}"  html-placeholder="{!$Label.End_Date_Field_Label}"/>          
                </apex:outputPanel>     
            </apex:pageBlockSectionItem>  
       
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Oracle_Project_No}"/>
                <apex:outputPanel >
                    <apex:outputField value="{!project.OracleProjectnumber__c}" rendered="{!mode == 'New'}"/>
                    <apex:outputField value="{!agreement.Project__r.OracleProjectnumber__c}" rendered="{!mode != 'New'}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>        
  
            <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.End_Client}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Account__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.Account__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>                     
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem >

            </apex:pageBlockSectionItem>
    
            <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Owner_Help_Text}">
                <apex:outputText value="{!$Label.Agreement_Owner_Label}"/>
                <apex:outputPanel >
                    <!-- <apex:inputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.ProjectTeamMember__c}" rendered="{!mode == ''}"/>   -->
                    <apex:inputField value="{!agreement.AgreementOwner__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.AgreementOwner__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
            </apex:pageBlockSectionItem> 

            <apex:pageBlockSectionItem >

            </apex:pageBlockSectionItem>
      
    </apex:pageBlockSection>

    <apex:pageBlockSection collapsible="false" title="{!$Label.Contract_Details}">

        <apex:pageBlockSectionItem helptext="{!$Label.Type_of_Contract_Document}">
            <apex:outputText value="{!$Label.Contract_Type}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementType__c}" rendered="{!mode != ''}" required="true"/>               
                <apex:outputField value="{!agreement.AgreementType__c}" rendered="{!mode == ''}"/>  
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>      

        <apex:pageBlockSectionItem helptext="{!$Label.Agreement_Created_Date_Field}">
            <apex:outputText value="{!$Label.Create_Date_Field_Label}"/>
            <apex:outputField value="{!agreement.CreatedDate}"/>                
        </apex:pageBlockSectionItem>         
            
        <apex:pageBlockSectionItem helptext="{!$Label.Enter_a_Title_or_Name_of_the_Contract}">
                <apex:outputText value="{!$Label.Task_Order_Title_Name}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ContractTitle__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ContractTitle__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.StartDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Start_Date}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.StartDate__c}" rendered="{!mode != ''}"/>               
                    <apex:outputField value="{!agreement.StartDate__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
        </apex:pageBlockSectionItem>                 
           
        <apex:pageBlockSectionItem helptext="Enter the Clients reference number (if applicable)">
                <apex:outputText value="{!$Label.Task_Order_Reference_No}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ClientContractReferenceNo__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ClientContractReferenceNo__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
        </apex:pageBlockSectionItem> 


        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExpirationDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.End_Date_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ExpirationDate__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.ExpirationDate__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>                         
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ProfIndemnityLiabilityAmt__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Prof_Indemnity_Liability_Amt}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ProfIndemnityLiabilityAmt__c}" rendered="{!mode != ''}"/>   
                    <apex:outputField value="{!agreement.ProfIndemnityLiabilityAmt__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>                                         
        </apex:pageBlockSectionItem>        

        <apex:pageBlockSectionItem >
                <apex:outputText value="{!$Label.Contract_Review_Status_Field_Label}"/>
                <apex:outputPanel >
                    <apex:outputText value="{!ContractReviewStatus}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>                                                 
        </apex:pageBlockSectionItem>   

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.PublicGeneralLiabilityAmt__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Public_General_Liability_Amt_Field_Label}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.PublicGeneralLiabilityAmt__c}" rendered="{!mode != ''}"/>               
                <apex:outputField value="{!agreement.PublicGeneralLiabilityAmt__c}" rendered="{!mode == ''}"/>      
            </apex:outputPanel>     
        </apex:pageBlockSectionItem>            

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ContractTypeComments__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Contract_Type_Comments}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.ContractTypeComments__c}" rendered="{!mode != ''}"/>               
                <apex:outputField value="{!agreement.ContractTypeComments__c}" rendered="{!mode == ''}"/>      
            </apex:outputPanel>     
        </apex:pageBlockSectionItem>

    </apex:pageBlockSection>

    <apex:pageBlockSection columns="1">
            <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ScopePackage__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Scope_Package_Field_Label}"/>
                <apex:outputPanel >
                    <!--<apex:inputField value="{!agreement.ScopePackage__c}" onChange="subScopeChanged();" rendered="{!mode != ''}"/>-->
                    <apex:inputField value="{!agreement.ScopePackage__c}" rendered="{!mode != ''}"/>
                    <apex:outputField value="{!agreement.ScopePackage__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:pageBlockSectionItem>    
            
            <apex:pageBlockSectionItem helptext="{!$Label.Scope_of_Services_Message}">
                    <apex:outputText value="{!$Label.Scope_of_Services}"/>
                    <apex:outputPanel id="subScope">
                        <apex:inputField style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode != ''}"/>   
                        <apex:outputField style="width: 780px" value="{!agreement.ScopeOfServices__c}" rendered="{!mode == ''}"/>
                        <!--<apex:outputField style="width: 780px" value="{!agreement.ScopePackage__r.Scope_Details__c}" rendered="{!agreement.ScopePackage__c != null}"/>  -->        
                    </apex:outputPanel>         
            </apex:pageBlockSectionItem> 
                                                                                                                                
    </apex:pageBlockSection>

    <apex:outputPanel id="taskOrderFinancial">
    <apex:pageBlockSection collapsible="false" title="{!$Label.Agreement_Currency_Note}" >      

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FeeType__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Fee_Type}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.FeeType__c}" rendered="{!mode != ''}" required="true"/>
                <apex:outputField value="{!agreement.FeeType__c}" rendered="{!mode == ''}"/>        
            </apex:outputPanel>     
        </apex:pageBlockSectionItem> 

        <apex:pageBlockSectionItem helpText="{!$Label.Total_Amount_of_Revenue_Message}" >
            <apex:outputText value="{!$Label.Total_Approved_Revenue_Limit}"/>
            <apex:outputPanel id="totalApprovedRevenueLimit">
                <apex:outputPanel >
                        <apex:inputField value="{!agreement.TotalApprovedRevenueLimit__c}" rendered="{!mode != ''}" />
                    <apex:outputField value="{!agreement.TotalApprovedRevenueLimit__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem id="termId">
                <apex:outputText value="{!$Label.Payment_Terms_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.PaymentTerms__c}" rendered="{!mode != ''}" required="true"/>
                    <apex:outputField value="{!agreement.PaymentTerms__c}" rendered="{!mode == ''}"/>
                </apex:outputPanel> 
        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem helpText="{!$Label.Total_Funding_Entered}">
                <apex:outputText value="{!$Label.Total_Funding_Amount}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode != ''}"/>              
                    <apex:outputField value="{!agreement.TotalFundingAmount__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>         
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FundingCurrencyCode__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Currency}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode != ''}" required="true"/>
                <apex:outputField value="{!agreement.FundingCurrencyCode__c}" rendered="{!mode == ''}"/>    
            </apex:outputPanel>         
        </apex:pageBlockSectionItem>    

        <apex:pageBlockSectionItem helpText="{!$Label.Variance_Between_Approved_Revenue_and_Funding}">
            <apex:outputText value="{!$Label.Unallocated_Funding}"/>
            <apex:outputPanel >
                <apex:outputField value="{!agreement.UnallocatedFunding__c}" rendered="{!mode == ''}"/>    
            </apex:outputPanel>

        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementAmountEstimated__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Amount_Estimated}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode != ''}"/>                
                <apex:outputField value="{!agreement.AgreementAmountEstimated__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel> 

        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem helptext="{!$Label.Variance_Between_Approved_and_Confirmed}">
                <apex:outputText value="{!$Label.Variance_Field_Label}"/>
                <apex:outputField value="{!agreement.AgreementVariance__c}"/>                
        </apex:pageBlockSectionItem>  

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Amount__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Confirmed_And_Committed_Field_Label}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.Amount__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.Amount__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
        </apex:pageBlockSectionItem>
            
        <apex:pageBlockSectionItem helpText="{!$Label.Pick_Variance_Reason}">
            <apex:outputText value="{!$Label.Variance_Reason_Field_Label}"/>
            <apex:outputPanel >
                    <apex:inputField value="{!agreement.VarianceReason__c}" rendered="{!mode != ''}"/>  
                <apex:outputField value="{!agreement.VarianceReason__c}" rendered="{!mode == ''}"/> 
            </apex:outputPanel>                                                 
        </apex:pageBlockSectionItem>            
              
        <apex:pageBlockSectionItem helpText="{!$ObjectType.Agreement__c.Fields.PotentialPerformanceBonus__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Potential_Performance_Bonus}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.PotentialPerformanceBonus__c}" rendered="{!mode != ''}"/>  
                <apex:outputField value="{!agreement.PotentialPerformanceBonus__c}" rendered="{!mode == ''}"/> 
            </apex:outputPanel>                                                 
        </apex:pageBlockSectionItem> 

    </apex:pageBlockSection>

    <apex:pageBlockSection collapsible="false" columns="1">
            <apex:pageBlockSectionItem helpText="{!$ObjectType.Agreement__c.Fields.FinancialComments__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Financial_Comments}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.FinancialComments__c}" rendered="{!mode != ''}" style="width: 780px"/>  
                    <apex:outputField value="{!agreement.FinancialComments__c}" rendered="{!mode == ''}" style="width: 780px"/> 
                </apex:outputPanel>                                                 
            </apex:pageBlockSectionItem> 
    </apex:pageBlockSection>

<apex:pageBlockSection title="Interim Agreement / Work At Risk  (if applicable)" collapsible="false" columns="2">
            <apex:pageBlockSectionItem helptext="If work is commencing under an interim agreement, select which type of interim agreement is being used.">
                <apex:outputText value="Interim Approval Type"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.InterimApprovalType__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.InterimApprovalType__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="Enter the date the interim approval was obtained.">
                <apex:outputText value="Interim Approval Date" />
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.InterimApprovalDate__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.InterimApprovalDate__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="Enter the total revenue limit that is included with the interim approval. This should be entered in the project functional currency - not the agreement currency.">
                <apex:outputText value="Interim Approval Revenue/Fee Limit"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.InterimApprovalRevenueFeeLimit__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.InterimApprovalRevenueFeeLimit__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helptext="Enter the date the interim approval expires.">
                <apex:outputText value="Interim Approval Expiry Date"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.InterimApprovalExpiryDate__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.InterimApprovalExpiryDate__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>

            <apex:pageBlockSectionItem helpText="Enter the total cost limit that is included with the interim approval - this is inclusive of labor, subs and ODC costs. This should be entered in the project functional currency - not the agreement currency." >
                <apex:outputText value="Interim Approval Cost Limit"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.InterimApprovalCostLimit__c}" rendered="{!mode != ''}"/>  
                    <apex:outputField value="{!agreement.InterimApprovalCostLimit__c}" rendered="{!mode == ''}"/> 
                </apex:outputPanel>
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>

        <apex:pageBlockSection columns="1">
                <apex:pageBlockSectionItem helpText="Include any specific notes or conditions relating to the interim approval.  In the case of an AECOM DoA Approval, please reference the DoA Approval number.">
                    <apex:outputText value="Interim Approval Comments"/>
                    <apex:outputPanel >
                        <apex:inputField style="width:780px" value="{!agreement.InterimApprovalComments__c}" rendered="{!mode != ''}"/>  
                        <apex:outputText style="width:780px" value="{!agreement.InterimApprovalComments__c}" rendered="{!mode == ''}"/> 
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
        </apex:pageBlockSection>    

    <apex:pageBlockSection collapsible="false" title="{!$Label.Agreement_Execution_Details}" id="taskOrderExecutionDetails">
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c == 'Executed'}"/>
                    <apex:outputField value="{!agreement.AgreementExecutedBy__c}" rendered="{!mode == ''}"/>    
                </apex:outputPanel>         
        </apex:pageBlockSectionItem>
                                
        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExecutionDate__c.inlineHelpText}">
                <apex:outputText value="{!$Label.Execution_Date}"/>
                <apex:outputPanel >
                    <apex:inputField value="{!agreement.ExecutionDate__c}" rendered="{!mode != ''}" required="{!agreement.AgreementStatus__c == 'Executed'}"/>
                    <apex:outputField value="{!agreement.ExecutionDate__c}" rendered="{!mode == ''}"/>  
                </apex:outputPanel>         
        </apex:pageBlockSectionItem>

        <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy__c.inlineHelpText}">
            <apex:outputText value="{!$Label.Agreement_Executed_By}"/>
            <apex:outputPanel >
                <apex:inputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode != ''}"/>
                <apex:outputField value="{!agreement.AgreementExecutedBy2__c}" rendered="{!mode == ''}"/>
            </apex:outputPanel>
        </apex:pageBlockSectionItem>         

    </apex:pageBlockSection>
    </apex:outputPanel>

                        
        </apex:pageBlock>   

        <apex:pageBlock title="{!$Label.Funding}" rendered="{!mode == ''}">
            <apex:pageBlockButtons location="top"><apex:commandButton value="{!$Label.Manage_Funding}" action="{!manageFunding}" immediate="true"/></apex:pageBlockButtons>
            <apex:outputPanel rendered="{!fundings != null && fundings.size > 0}">
            <apex:pageBlockTable value="{!fundings}" var="funding">
                <apex:column headervalue="{!$Label.Date_Allocated}">
                    <apex:outputField value="{!funding.CreatedDate}" rendered="{!funding.DateAllocatedDate__c == null}"></apex:outputField>
                    <apex:outputField value="{!funding.DateAllocatedDate__c}" rendered="{!funding.DateAllocatedDate__c != null}"></apex:outputField>                    
                </apex:column>         
                <apex:column headervalue="{!$Label.Classification}">
                    <apex:outputField value="{!funding.FundingClassification__c}"/>
                </apex:column>          
                <apex:column headervalue="{!$Label.Allocated_Amount}">
                    <apex:outputField value="{!funding.TotalBaselinedAmount__c}" rendered="{!funding.AllocatedAmount__c==null}"/>
                    <apex:outputField value="{!funding.AllocatedAmount__c}" rendered="{!funding.AllocatedAmount__c!=null}"/>
                </apex:column>
        </apex:pageBlockTable>      
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!fundings.size == 0}">
            <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
        </apex:outputPanel> 
        </apex:pageBlock>   

        <apex:pageBlock title="{!$Label.Contract_Reviews}" rendered="{!mode == ''}">
        <apex:outputPanel rendered="{!contractReviews != null && contractReviews.size > 0}">
            <apex:pageBlockTable value="{!contractReviews}" var="contractReview">
    
                <apex:column headervalue="{!$Label.Contract_Review_Id}">
                    <apex:commandlink action="{!URLFOR($Action.Contract_Review__c.view, contractReview.Id)}"><apex:outputField value="{!contractReview.Name}"/></apex:commandLink>
                </apex:column>          

                <apex:column headervalue="{!$Label.Review_Status}">
                    <apex:outputField value="{!contractReview.Status_Review__c}"/>
                </apex:column>    
                <apex:column headervalue="{!$Label.Review_Request_Type}">
                    <apex:outputField value="{!contractReview.Review_Request_Type__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Opportunity_Name}">
                    <apex:outputField value="{!contractReview.Opportunity_Name__c}"/>
                </apex:column>  
                <apex:column headervalue="{!$Label.Date_Review_is_Required}">
                    <apex:outputField value="{!contractReview.Date_Required__c}"/>
                </apex:column>                                  
                <apex:column headervalue="{!$Label.Client_Vendor}">
                    <apex:outputField value="{!contractReview.Client_Vendor__c}"/>
                </apex:column>  
            </apex:pageBlockTable>

        </apex:outputPanel>
        <apex:outputPanel rendered="{!contractReviews == null || contractReviews.size == 0}">
            <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
        </apex:outputPanel> 
        </apex:pageBlock>  
        
        <apex:pageBlock title="{!$Label.MSA_DOA_Conditions_of_Approval}" rendered="{!mode == ''}">
            <apex:outputPanel rendered="{!msaDOAConditions != null && msaDOAConditions.size > 0}">
            <apex:pageBlockTable value="{!msaDOAConditions}" var="condition">
                <apex:column headervalue="{!$Label.ECO_Name}"><apex:commandlink action="{!URLFOR($Action.DOAConditions__c.view, condition.Id)}"><apex:outputField value="{!condition.Name}"/></apex:commandLink></apex:column>               
                <apex:column headervalue="{!$Label.Condition}"><apex:outputField value="{!condition.ConditionLongText__c}"/></apex:column> 
                <apex:column headervalue="{!$Label.ECO_Status}"><apex:outputField value="{!condition.Mitigation_Plan__c}"/></apex:column> 
                <apex:column headervalue="{!$Label.Approver}"><apex:outputField value="{!condition.CreatedBy__c}"/></apex:column>                      
            </apex:pageBlockTable>
            </apex:outputPanel>
            <apex:outputPanel rendered="{!msaDOAConditions == null || msaDOAConditions.size == 0}">
                <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
            </apex:outputPanel> 
        </apex:pageBlock>   
        
        <apex:pageBlock title="{!$Label.MSA_Management_Team_Members}" rendered="{!mode == ''}">
            <apex:outputPanel rendered="{!msaManagementTeamMembers != null && msaManagementTeamMembers.size > 0}">
            <apex:pageBlockTable value="{!msaManagementTeamMembers}" var="managementTeamMember">
                <apex:column headervalue="{!$Label.ECO_Role}"><apex:outputField value="{!managementTeamMember.Role__c}"/></apex:column>                   
                <apex:column headervalue="{!$Label.Name}"><apex:outputField value="{!managementTeamMember.TeamMember__r.Name}"/></apex:column>
                <!--<apex:column headervalue="Phone"><apex:outputField value="{!managementTeamMember.Phone__c}"/></apex:column> -->                 
                <!--<apex:column headervalue="Email"><apex:outputField value="{!managementTeamMember.Email__c}"/></apex:column>-->
            </apex:pageBlockTable>
            </apex:outputPanel>
            <apex:outputPanel rendered="{!msaManagementTeamMembers == null || msaManagementTeamMembers.size == 0}">
                <apex:outputText value="{!$Label.NoRecordsToDisplay}"/>
            </apex:outputPanel>             
        </apex:pageBlock>           
        
        <c:ECO_RiskFlyout ProjectId="{!project.Id}" PlanElement="" rendered="{!project != null}"/>
        <c:ECO_AssumptionFlyout ProjectId="{!project.Id}" PlanElement="Agreements" rendered="{!project != null}"/>
        <c:ECO_ProjectTeamFlyout ProjectId="{!project.Id}" rendered="{!project != null}"  />
       <!--  <c:ECO_MSABillRateFlyout ProjectId="{!Agreement__c.Project__c}" rendered="{!Agreement__c.Project__c != null}" />  -->
        
       <!--  <c:ECO_MSAFlyout MSAId="{!agreement.Id}" />  -->

    </apex:form>
    <!--<apex:relatedList list="ContractReviews__r" rendered="{!mode==''}"/> -->
    <c:ECO_GenericHistoryComponent recordLimit1="50" myObject1="{!Agreement__c}" />
    <apex:relatedList list="CombinedAttachments" rendered="{!mode==''}"/>
    
    </apex:outputPanel> 
    
</apex:page>