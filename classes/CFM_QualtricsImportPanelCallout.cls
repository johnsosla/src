public with sharing class CFM_QualtricsImportPanelCallout extends CFM_QualtricsBaseCallout{

    public static final String PARAM_KEY_ALLED       = 'AllED';
    public static final String PARAM_KEY_COL_HEADERS = 'ColumnHeaders';
    public static final String PARAM_KEY_LIB_ID      = 'LibraryID';
    public static final String PARAM_KEY_EMAIL       = 'Email';
    public static final String PARAM_KEY_LANG        = 'Language';

    private String mSurveyBatchProjectCSV;

    public CFM_QualtricsImportPanelCallout() {
        super();
    }

    public CFM_QualtricsImportPanelCallout(Id surveyBatchId, String surveyBatchProjectCSV) {
        super();
        mSurveyBatchId = surveyBatchId;
        mSurveyBatchProjectCSV = surveyBatchProjectCSV;
    }

    public override Map<String, String> getAdditionalHeaders() {
        Map<String, String> headers = new Map<String, String>{
            PARAM_KEY_ALLED       => '1',
            PARAM_KEY_COL_HEADERS => '1'
        };
        headers.put(PARAM_KEY_LIB_ID, getLibraryID());
        headers.put(PARAM_KEY_EMAIL,  String.valueOf(getEmailColumn()));
        headers.put(PARAM_KEY_LANG, String.valueOf(getLanguageColumn()));
        return headers;
    }

    public override String getHTTPMethod() {
        return 'POST';
    }

    public override String getRequest() {
        return 'importPanel';
    }

    public override String getPanelID() {
        //---Return a value that was generated by a prior importPanel callout
        //---In order to append the rows in this callout to the previous list
        //---In the Qualtrics system
        return null;
    }

    public override String getVersion() {
        return mSettings.Qualtrics_Import_Panel_Version__c;
    }

    public Integer getEmailColumn() {
        //---Index starts at 0, Qualtrics starts at 1
        return CFM_SurveyBatchProjectCSVGenerator.getEmailColumnIndex() + 1;
    }

    public Integer getLanguageColumn() {
        return CFM_SurveyBatchProjectCSVGenerator.getLanguageColumnIndex() + 1;
    }

    public override String getBodyForPost() {
        return mSurveyBatchProjectCSV;
    }

    public String getLibraryID() {
        return mSettings.Qualtrics_Library_ID__c;
    }

    public String getSurveyBatchProjectCSV() {
        return mSurveyBatchProjectCSV;
    }
    public void setSurveyBatchProjectCSV(String surveyBatchProjectCSV) {
        mSurveyBatchProjectCSV = surveyBatchProjectCSV;
    }
}